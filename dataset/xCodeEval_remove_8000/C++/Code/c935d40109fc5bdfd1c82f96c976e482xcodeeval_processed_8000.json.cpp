










































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































using namespace std;
namespace IO {
	char ibuf[iL],*iS=ibuf+iL,*iT=ibuf+iL,Out[iL],*iter=Out;
	TEM Readneg(re T &x) {
		re char c;
		re bool f;
		for(f=false,c=getchar(); !isdigit(c); f|=c=='-',c=getchar());
		for(x=0; isdigit(c); x=(x<<1)+(x<<3)+(c^48),c=getchar());
		if(f)x=~x+1;
	}
	TEM readneg(re T &x) {
		re char c;
		re bool f;
		for(f=false,c=gc(); !isdigit(c); f|=c=='-',c=gc());
		for(x=0; isdigit(c); x=(x<<1)+(x<<3)+(c^48),c=gc());
		if(f)x=~x+1;
	}
	TEM id0(re T x) {
		if(x<0)*iter++='-',x=~x+1;
		re T c[35],l;
		for(l=0; !l || x; c[l]=x%10,++l,x/=10);
		for(; l; --l,*iter++=c[l]+'0');
		flush();
	}
	TEM Read(re T &x) {
		re char c;
		for(c=getchar(); !isdigit(c); c=getchar());
		for(x=0; isdigit(c); x=(x<<1)+(x<<3)+(c^48),c=getchar());
	}
	TEM read(re T &x) {
		re char c;
		for(c=gc(); !isdigit(c); c=gc());
		for(x=0; isdigit(c); x=(x<<1)+(x<<3)+(c^48),c=gc());
	}
	TEM write(re T x) {
		re T c[35],l;
		for(l=0; !l||x; c[l++]=x%10,x/=10);
		for(; l; *iter++=c[--l]+'0');
		flush();
	}
}
using namespace IO;















 








int m,n;
int a[1<<17|1],b[1<<17|1];
vector<pii>G[1<<17|1];
il void Add(int x,int y,int w){G[x].emplace_back(MP(y,w));}
void DFS(int x,int fa,int d){
  for(auto y:G[x]){
    if(y.fi==fa)continue;
    if(!d)a[y.fi]=y.fi,b[y.se]=n^y.fi;
    else a[y.fi]=n^y.fi,b[y.se]=y.fi;
    DFS(y.fi,x,!d);
  }
}
il void WORK(){
  scanf("%d",&m),n=1<<m;
  for(re int i=1;i<=n;++i)G[i].resize(0);
  for(re int i=1,x,y;i<n;++i)scanf("%d%d",&x,&y),Add(x,y,i),Add(y,x,i);
  DFS(n,0,0),printf("%d\n",n);
  for(re int i=1;i<n;++i)printf("%d ",a[i]);printf("%d\n",n);
  for(re int i=1;i<n;++i)printf("%d ",b[i]);printf("\n");
}








int main(){
	

	srand(time(0));
	re int T=1;
  scanf("%d",&T);
	



	

	

	for(re int i=0; i<T; ++i)WORK();
	

	

	

	return 0;
}