


































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































#include<stdio.h>
#include <iostream>
#include <math.h>
#include <numeric>
#include <vector>
#include <map>
#include <functional>
#include <stdio.h>
#include <algorithm>
#include <string>
#include <assert.h>
#include <stdio.h>
#include <queue>
#include<iomanip>
#include<bitset>
#include<stack>
using namespace std;
#include <array>

int main(){
	int n;
	cin >> n;
	vector<long long int >heights(n);
	for (int i = 0; i < n; ++i){
		int x, y;
		cin >> x >> y;
		heights[x]++;
	}

	vector<long long int >uses(n);
	map<int, pair<int, int>> kouho;
	kouho[0] = make_pair(0, 0);
	vector<pair<int, int>>anss;
	for (int i = 0; i < n; ++i){
		int a;
		cin >> a;		if (kouho.count(a)){
			int ax = kouho[a].first;
			int ay = kouho[a].second;
			kouho.erase(a);
			uses[ax]++;
			anss.push_back(make_pair(ax, ay));
			if (ax == 0 || uses[ax - 1]>ay){
				if (heights[ax]>ay+1)
					kouho[-(ax - (ay + 1))] = make_pair(ax, ay + 1);
			}
			if (ay == 0 || uses[ax]>ay-1){
				if (heights[ax+1]>ay)
					kouho[-((ax + 1) - ay)] = make_pair(ax + 1, ay);
			}
		}
		else{
			cout << "NO" << endl;
			return 0;
		}
	}
	cout << "YES" << endl;
	for (int i = 0; i < anss.size(); ++i){
		cout << anss[i].first << " " << anss[i].second << endl;

	}
	return 0;
}