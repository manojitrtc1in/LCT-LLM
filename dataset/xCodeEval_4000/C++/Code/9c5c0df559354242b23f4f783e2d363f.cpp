








#define vytautas	




#ifdef Vytautas
#undef vYtautas
#include<cassert>
#endif
#include<cmath>
#include<cstring>
#include<cstdlib>
#include<climits>
#include<cfloat>
#if defined vYtautas or !defined VYtautas
#include<cstdio>
#else
#include<iostream>
#endif
#include<bitset>
#include<vector>
#include<algorithm>
#include<queue>
#include<string>
#include<map>
#include<set>
#include<hash_set>
#include<hash_map>
#define vyTautas VyTautas
#define vYTautas first
#define VYTautas second
#define vytAutas push_back
#define VytAutas vYtAutas
#define VYtAutas pop_back
#define vyTAutas VyTAutas
#define vYTAutas insert
#define VYTAutas erase
#define vytaUtas iterator
#define VytaUtas begin()
#define vYtaUtas end()
#define VYtaUtas vyTaUtas
#define VyTaUtas(vYTaUtas) VYTaUtas(vYTaUtas)
#define vytAUtas(VytAUtas,vYtAUtas) VYTaUtas(vYtAUtas) VytAUtas(vYtAUtas)
#define VYtAUtas(vyTAUtas,VyTAUtas) for(vytAUtas(vyTAUtas,(VyTAUtas).VytaUtas);vyTAUtas!=(VyTAUtas).vYtaUtas;++vyTAUtas)
#define vYTAUtas(vyTAUtas,VyTAUtas) for(vytAUtas(vyTAUtas,(VyTAUtas).VYTAUtas());vyTAUtas!=(VyTAUtas).vytauTas();++vyTAUtas)
#define VytauTas(vYtauTas,VYtauTas) for(int vYtauTas=0; vYtauTas<(VYtauTas); ++vYtauTas)
#define vyTauTas(vYtauTas,VYtauTas) for(int vYtauTas=(VYtauTas)-1; vYtauTas>=0; --vYtauTas)
#define VyTauTas(vYtauTas,VytAUtas,vYTauTas) for(int vYtauTas=(VytAUtas); vYtauTas<(vYTauTas); ++vYtauTas)
#define VYTauTas(vYtauTas,VytAUtas,vYTauTas) for(int vYtauTas=(vYTauTas)-1; vYtauTas>=(VytAUtas); --vYtauTas)
#define vytAuTas(VytAuTas) (int)(VytAuTas).size()
const char vYtAuTas='\n';
const char VYtAuTas=' ';
using namespace std;using namespace __gnu_cxx;typedef char vyTAuTas;typedef long long VyTAuTas;typedef unsigned int vYTAuTas;typedef unsigned short VYTAuTas;typedef unsigned char vytaUTas;typedef unsigned long long VytaUTas;typedef pair<int,int> vYtaUTas;typedef pair<vYTAuTas,vYTAuTas> VYtaUTas;typedef pair<int,vYTAuTas> vyTaUTas;typedef pair<vYTAuTas,int> VyTaUTas;typedef pair< VyTAuTas,VyTAuTas> vYTaUTas;typedef pair<VytaUTas,VytaUTas> VYTaUTas;typedef pair<VytaUTas, VyTAuTas> vytAUTas;typedef pair<VyTAuTas, VytaUTas> VytAUTas;typedef pair<char,char> vYtAUTas;typedef pair<char,vytaUTas> VYtAUTas;typedef pair<vytaUTas,char> vyTAUTas;typedef pair<vytaUTas,vytaUTas> VyTAUTas;typedef pair<int,VyTAuTas> vYTAUTas;typedef pair<VyTAuTas,int> VYTAUTas;typedef pair<vYTAuTas,VyTAuTas> vytautAs;typedef pair<VyTAuTas,vYTAuTas> VytautAs;typedef pair<VytaUTas,int> vYtautAs;typedef pair<int,VytaUTas> VYtautAs;typedef pair<vYTAuTas,VytaUTas> vyTautAs; typedef pair<VytaUTas,vYTAuTas> VyTautAs;typedef pair<char,VyTAuTas> vYTautAs;typedef pair<VyTAuTas,char> VYTautAs;typedef pair<vytaUTas,VyTAuTas> vytAutAs;typedef pair<VyTAuTas,vytaUTas> VytAutAs;typedef pair<VytaUTas,char> vYtAutAs;typedef pair<char,VytaUTas> VYtAutAs;typedef pair<vytaUTas,VytaUTas> vyTAutAs; typedef pair<VytaUTas,vytaUTas> VyTAutAs;typedef pair<char,int> vYTAutAs;typedef pair<int,char> VYTAutAs;typedef pair<vytaUTas,int> vytaUtAs;typedef pair<int,vytaUTas> VytaUtAs;typedef pair<vYTAuTas,char> vYtaUtAs;typedef pair<char,vYTAuTas> VYtaUtAs;typedef pair<vytaUTas,vYTAuTas> vyTaUtAs; typedef pair<vYTAuTas,vytaUTas> VyTaUtAs;
struct vYTaUtAs{size_t operator()(VyTAuTas vYTaUtas)const{return (int)vYTaUtas^(int)(vYTaUtas>>32);}};
struct VYTaUtAs{size_t operator()(VytaUTas vYTaUtas)const{return (vYTAuTas)vYTaUtas^(vYTAuTas)(vYTaUtas>>32);}};




struct vytAUtAs{size_t operator()(vYtaUTas vYTaUtas)const{return vYTaUtas.vYTautas^vYTaUtas.VYTautas;}};

#ifdef Vytautas
#define VytAUtAs(vYTaUtas) vYtAUtAs(vYTaUtas);
#define VYtAUtAs
#else
#define VytAUtAs(vYTaUtas)
#define VYtAUtAs if(0)
#endif
#ifndef vYtautas
inline void vyTAUtAs(int){}inline void VyTAUtAs(int){}
#ifdef VYtautas
inline int vYTAUtAs(){int VYTAUtAs;cin>>VYTAUtAs;return VYTAUtAs;}
inline vYTAuTas vytauTAs(){vYTAuTas VYTAUtAs;cin>>VYTAUtAs;return VYTAUtAs;}
inline VytaUTas VytauTAs(){VytaUTas VYTAUtAs;cin>>VYTAUtAs;return VYTAUtAs;}
inline char vYtauTAs(){return cin.VYtauTAs();}
template<typename vyTauTAs>inline void VyTauTAs(const vyTauTAs& vYtauTas){cout<<vYtauTas;}
inline void VyTauTAs(){VyTauTAs('\n');}
#else
inline int vYTAUtAs(){int VYTAUtAs;scanf("%d",&VYTAUtAs);return VYTAUtAs;}
inline vYTAuTas vytauTAs(){vYTAuTas VYTAUtAs;scanf("%u",&VYTAUtAs);return VYTAUtAs;}
inline VytaUTas VytauTAs(){VytaUTas VYTAUtAs;scanf("%llu",&VYTAUtAs);return VYTAUtAs;}
inline VytaUTas vYTauTAs(){VyTAuTas VYTAUtAs;scanf("%lld",&VYTAUtAs);return VYTAUtAs;}
inline char vYtauTAs(){return getchar();}
inline void VyTauTAs(char VytAUtas='\n'){printf("%c",VytAUtas);}
inline void VyTauTAs(int VytAUtas){printf("%d",VytAUtas);}
inline void VyTauTAs(vYTAuTas VytAUtas){printf("%u",VytAUtas);}
inline void VyTauTAs(const VytaUTas& VytAUtas){printf("%llu",VytAUtas);}
inline void VyTauTAs(const VyTAuTas& VytAUtas){printf("%lld",VytAUtas);}
inline void VyTauTAs(const char *VYTauTAs){fputs(VYTauTAs,stdout);}
#endif
#else
#ifdef vytAuTAs
#define VytAuTAs fread_unlocked
#define vYtAuTAs fwrite_unlocked
#else
#define VytAuTAs fread
#define vYtAuTAs fwrite
#endif
const int VYtAuTAs=32768;const int vyTAuTAs=32768;
char VyTAuTAs[VYtAuTAs];int vYTAuTAs = 0;char VYTAuTAs[vyTAuTAs];int vytaUTAs = 0;
inline void vyTAUtAs(int VytaUTAs){int VYTAUtAs=VYtAuTAs-vYTAuTAs;if(VYTAUtAs>VytaUTAs)return;VytauTas(vYtauTas,VYTAUtAs)VyTAuTAs[vYtauTas]=VyTAuTAs[vYtauTas+vYTAuTAs];
    VytAuTAs(VyTAuTAs+VYTAUtAs,1,vYTAuTAs,stdin);vYTAuTAs = 0;}
inline void VyTAUtAs(int VytaUTAs){if(vyTAuTAs-vytaUTAs>VytaUTAs)return;vYtAuTAs(VYTAuTAs,1,vytaUTAs,stdout);vytaUTAs = 0;}
inline char vYtauTAs(){return VyTAuTAs[vYTAuTAs++];}
inline void VyTauTAs(char VytAuTas='\n'){VYTAuTAs[vytaUTAs++]=VytAuTas;}
template<class vyTauTAs>inline vyTauTAs vYtaUTAs(){
    vyTauTAs VYTAUtAs=0;char VytAuTas=vYtauTAs();
    do VytAuTas-='0',VYTAUtAs=VYTAUtAs*10+VytAuTas,VytAuTas=vYtauTAs();while(VytAuTas>='0');
    return VYTAUtAs;}
template<class vyTauTAs>inline vyTauTAs VYtaUTAs(){
	char VytAuTas=vYtauTAs();
	while(VytAuTas<'-')VytAuTas=vYtauTAs();
	if(VytAuTas=='-')return -vYtaUTAs<vyTauTAs>();
	else{--vYTAuTAs;return vYtaUTAs<vyTauTAs>();}}
template<class vyTauTAs>inline vyTauTAs vyTaUTAs(){while(vYtauTAs()<'0');--vYTAuTAs;return vYtaUTAs<vyTauTAs>();}
inline int vYTAUtAs(){vyTAUtAs(15);return VYtaUTAs<int>();}
inline vYTAuTas vytauTAs(){vyTAUtAs(15);return vyTaUTAs<vYTAuTas>();}
inline VyTAuTas vYTauTAs(){vyTAUtAs(25);return VYtaUTAs<VyTAuTas>();}
inline VytaUTas VytauTAs(){vyTAUtAs(25);return vyTaUTAs<VytaUTas>();}
const int VyTaUTAs = 20;char vYTaUTAs[VyTaUTAs];
template<class vyTauTAs>inline void VYTaUTAs(vyTauTAs vYtauTas){
	if(vYtauTas<0)VyTauTAs('-'),vYtauTas=-vYtauTas;
	else if(vYtauTas==0){VyTauTAs('0');return;}
	int vytAUTAs = VyTaUTAs;
	do{vYTaUTAs[--vytAUTAs]='0'+vYtauTas%10;vYtauTas/=10;}while(vYtauTas);
	do VyTauTAs(vYTaUTAs[vytAUTAs]),++vytAUTAs;while(vytAUTAs<VyTaUTAs);}
inline void VyTauTAs(int vYtauTas){VyTAUtAs(15);VYTaUTAs(vYtauTas);}
inline void VyTauTAs(unsigned int vYtauTas){VyTAUtAs(15);VYTaUTAs(vYtauTas);}
inline void VyTauTAs(long long vYtauTas){VyTAUtAs(25);VYTaUTAs(vYtauTas);}
inline void VyTauTAs(unsigned long long vYtauTas){VyTAUtAs(25);VYTaUTAs(vYtauTas);}
#endif
template<class VytAUtAs,class VytAUTAs>inline void VyTauTAs(const VytAUtAs&VytAUtas,const VytAUTAs&vYTauTas){VyTauTAs(VytAUtas);VyTauTAs(vYTauTas);}
template<class VytAUtAs,class VytAUTAs,class vYtAUTAs>
inline void VyTauTAs(const VytAUtAs&VytAUtas,const VytAUTAs&vYTauTas,const vYtAUTAs&VytAuTas){VyTauTAs(VytAUtas);VyTauTAs(vYTauTas);VyTauTAs(VytAuTas);}
template<class VytAUtAs,class VytAUTAs,class vYtAUTAs,class VYtAUTAs>
inline void VyTauTAs(const VytAUtAs&VytAUtas,const VytAUTAs&vYTauTas,const vYtAUTAs&VytAuTas,const VYtAUTAs&vyTAUTAs){VyTauTAs(VytAUtas);VyTauTAs(vYTauTas);VyTauTAs(VytAuTas);VyTauTAs(vyTAUTAs);}
template<class vyTauTAs>inline void VyTAUTAs(vyTauTAs&vYTAUTAs){sort(vYTAUTAs.VytaUtas,vYTAUTAs.vYtaUtas);}
template<class vyTauTAs>inline void VYTAUTAs(vyTauTAs&vYTAUTAs){vYTAUTAs.vytautaS(VytautaS(vYTAUTAs.VytaUtas,vYTAUTAs.vYtaUtas)-vYTAUTAs.VytaUtas);}
inline int vYtautaS(vYTAuTas vYtauTas){return __builtin_popcount(vYtauTas);}
inline int vYtautaS(int vYtauTas){return __builtin_popcount(vYtauTas);}
inline int vYtautaS(VytaUTas vYtauTas){return __builtin_popcountll(vYtauTas);}
inline int VYtautaS(vYTAuTas vYtauTas){return __builtin_parity(vYtauTas);}
inline int VYtautaS(VytaUTas vYtauTas){return __builtin_parityll(vYtauTas);}
inline int vyTautaS(vYTAuTas vYtauTas){return 31-__builtin_clz(vYtauTas);} 

inline int vyTautaS(VytaUTas vYtauTas){return 63-__builtin_clzll(vYtauTas);}
#define VyTautaS(vYTaUtas) !(vYTaUtas&(vYTaUtas-1))
#define vYTautaS(VytAUtas,vYTauTas) (VytAUtas&vYTauTas==VytAUtas)
#define VYTautaS(vytAutaS) ((1u<<vytAutaS)-1)
#define VytAutaS(vytAutaS,VYtauTas) ((VYTautaS(vytAutaS)<<(VYtauTas-vytAutaS))+1)
inline vYTAuTas vYtAutaS(vYTAuTas VytAUtas){vYTAuTas vYTauTas=(VytAUtas|(VytAUtas-1))+1;return vYTauTas|((VytAUtas^vYTauTas)>>(__builtin_ctz(VytAUtas)+2));}
#define VYtAutaS(vYTaUtas,vytAutaS,VYtauTas) for(vYTAuTas vYTaUtas=VYTautaS(vytAutaS);vYTaUtas<VytAutaS(vytAutaS,VYtauTas);vYTaUtas=vYtAutaS(vYTaUtas))
inline void vyTAutaS();
int main()
{
#ifdef vYtautas
    setvbuf ( stdin  , NULL , _IONBF , 0 );
    setvbuf ( stdout , NULL , _IONBF , 0 );
#ifdef vytautas
    VytAuTAs(VyTAuTAs, 1, VYtAuTAs, stdin);
#endif
#else
#ifdef VYtautas
	VyTAutaS::vYTAutaS(0);
	cout.VYTAutaS(40);
	cout.vytaUtaS(VytaUtaS::vYtaUtaS, VytaUtaS::VYtaUtaS);
#endif
#endif
#ifdef vyTaUtaS
	int VyTaUtaS;
#ifdef vYtautas
	vyTAUtAs(10);
	VyTaUtaS = vytauTAs();
#else
#ifdef VYtautas
	cin >> VyTaUtaS;
#else
	scanf("%d",&VyTaUtaS);
#endif
#endif
	for(int vYtauTas=0; vYtauTas<VyTaUtaS; ++vYtauTas)
#endif
	vyTAutaS();
#ifdef vYtautas
    vYtAuTAs(VYTAuTAs, 1, vytaUTAs, stdout);
#endif
	return 0;
}










int VYtauTas,vYTaUtaS,VYTaUtaS;

const int vytAUtaS = 100008;

vYTAuTas VytAUtaS[1<<20];

vector<int> vYtAUtaS;

char VYtAUtaS[20][vytAUtaS];


inline void vyTAutaS()
{
	VYtauTas=vytauTAs();
	vYTaUtaS=vytauTAs();
	VYTaUtaS=vytauTAs();

	VytauTas(vYtauTas,vYTaUtaS)
	{
		int vyTAUtaS = vytauTAs();
		VytauTas(VyTAUtaS,vyTAUtaS)VYtAUtaS[vYtauTas][vytauTAs()-1]=1;

		int vYTAUtaS=VYTaUtaS-1;
		VYTauTas(VyTAUtaS,0,VYtauTas)
		{
			if(VYtAUtaS[vYtauTas][VyTAUtaS])vYTAUtaS=VYTaUtaS;

			if(vYTAUtaS>0)VYtAUtaS[vYtauTas][VyTAUtaS]=1;

			--vYTAUtaS;
		}
	}

	VytauTas(vYtauTas,VYtauTas)
	{
		int VYTAUtaS=0;
		VytauTas(VyTAUtaS,vYTaUtaS)
		{
			VYTAUtaS<<=1;
			if(VYtAUtaS[VyTAUtaS][vYtauTas])VYTAUtaS|=1;
		}
		VytAUtaS[VYTAUtaS]=1;
	}

	VyTauTas(vytAutaS,1,vYTaUtaS+1)
	{
		VYtAutaS(VYTAUtaS,vytAutaS,vYTaUtaS)
		{
			

			bool vytauTaS=false;
			VytauTas(VytauTaS,20)
			{
				int vYtauTaS = 1<<VytauTaS;
				vYTAuTas VYtauTaS = ~vYtauTaS&VYTAUtaS;
				if(VYtauTaS!=VYTAUtaS && VytAUtaS[VYtauTaS]){vytauTaS=true;break;}
			}
			if(vytauTaS)VytAUtaS[VYTAUtaS]=1;
			else if(VytAUtaS[VYTAUtaS])vYtAUtaS.vytAutas(VYTAUtaS);
		}
	}

	

	


	int vyTauTaS=0;

	int VyTauTaS = INT_MAX;

	VytauTas(VYTAUtaS,1<<vYTaUtaS)
	{
		bool vYTauTaS=true;
		

		VytauTas(vYtauTas,vytAuTas(vYtAUtaS))
		{
			int VYTauTaS = vYtauTas+vyTauTaS;
			VYTauTaS%=vytAuTas(vYtAUtaS);
			int vytAuTaS = vYtAUtaS[VYTauTaS];
			if((vytAuTaS&VYTAUtaS)==0){vYTauTaS=false;vyTauTaS=VYTauTaS;break;}
		}
		if(!vYTauTaS)continue;

		VyTauTaS=min(VyTauTaS,vYtautaS(VYTAUtaS));
	}
	VyTauTAs(VyTauTaS,vYtAuTas);
}




























