#include <algorithm>
#include <bitset>
#include <cassert>
#include <cctype>
#include <climits>
#include <cmath>
#include <complex>
#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <ctime>
#include <deque>
#include <fstream>
#include <iomanip>
#include <iostream>
#include <map>
#include <numeric>
#include <queue>
#include <set>
#include <sstream>
#include <stack>
#include <string>
#include <vector>

#define EPS 1e-9
#define INF 1070000000LL
#define MOD 1000000007LL
#define fir first
#define foreach(it,X) for(__typeof((X).begin()) it=(X).begin();it!=(X).end();it++)
#define ite iterator
#define mp make_pair
#define rep(i,n) rep2(i,0,n)
#define rep2(i,m,n) for(int i=m;i<(n);i++)
#define pb push_back
#define sec second
#define sz(x) ((int)x.size())

using namespace std;

struct timer{
	time_t start;
	timer(){start=clock();}
	~timer(){cout<<1.*(clock()-start)/CLOCKS_PER_SEC<<" secs"<<endl;}
};

typedef istringstream iss;
typedef long long ll;
typedef pair<int,int> pi;
typedef stringstream sst;
typedef vector<int> vi;

int primes[4][1024] = {
	{10007,10009,10037,10039,10061,10067,10069,10079,10091,10093,10099,10103,10111,10133,10139,10141,10151,10159,10163,10169,10177,10181,10193,10211,10223,10243,10247,10253,10259,10267,10271,10273,10289,10301,10303,10313,10321,10331,10333,10337,10343,10357,10369,10391,10399,10427,10429,10433,10453,10457,10459,10463,10477,10487,10499,10501,10513,10529,10531,10559,10567,10589,10597,10601,10607,10613,10627,10631,10639,10651,10657,10663,10667,10687,10691,10709,10711,10723,10729,10733,10739,10753,10771,10781,10789,10799,10831,10837,10847,10853,10859,10861,10867,10883,10889,10891,10903,10909,10937,10939,10949,10957,10973,10979,10987,10993,11003,11027,11047,11057,11059,11069,11071,11083,11087,11093,11113,11117,11119,11131,11149,11159,11161,11171,11173,11177,11197,11213,11239,11243,11251,11257,11261,11273,11279,11287,11299,11311,11317,11321,11329,11351,11353,11369,11383,11393,11399,11411,11423,11437,11443,11447,11467,11471,11483,11489,11491,11497,11503,11519,11527,11549,11551,11579,11587,11593,11597,11617,11621,11633,11657,11677,11681,11689,11699,11701,11717,11719,11731,11743,11777,11779,11783,11789,11801,11807,11813,11821,11827,11831,11833,11839,11863,11867,11887,11897,11903,11909,11923,11927,11933,11939,11941,11953,11959,11969,11971,11981,11987,12007,12011,12037,12041,12043,12049,12071,12073,12097,12101,12107,12109,12113,12119,12143,12149,12157,12161,12163,12197,12203,12211,12227,12239,12241,12251,12253,12263,12269,12277,12281,12289,12301,12323,12329,12343,12347,12373,12377,12379,12391,12401,12409,12413,12421,12433,12437,12451,12457,12473,12479,12487,12491,12497,12503,12511,12517,12527,12539,12541,12547,12553,12569,12577,12583,12589,12601,12611,12613,12619,12637,12641,12647,12653,12659,12671,12689,12697,12703,12713,12721,12739,12743,12757,12763,12781,12791,12799,12809,12821,12823,12829,12841,12853,12889,12893,12899,12907,12911,12917,12919,12923,12941,12953,12959,12967,12973,12979,12983,13001,13003,13007,13009,13033,13037,13043,13049,13063,13093,13099,13103,13109,13121,13127,13147,13151,13159,13163,13171,13177,13183,13187,13217,13219,13229,13241,13249,13259,13267,13291,13297,13309,13313,13327,13331,13337,13339,13367,13381,13397,13399,13411,13417,13421,13441,13451,13457,13463,13469,13477,13487,13499,13513,13523,13537,13553,13567,13577,13591,13597,13613,13619,13627,13633,13649,13669,13679,13681,13687,13691,13693,13697,13709,13711,13721,13723,13729,13751,13757,13759,13763,13781,13789,13799,13807,13829,13831,13841,13859,13873,13877,13879,13883,13901,13903,13907,13913,13921,13931,13933,13963,13967,13997,13999,14009,14011,14029,14033,14051,14057,14071,14081,14083,14087,14107,14143,14149,14153,14159,14173,14177,14197,14207,14221,14243,14249,14251,14281,14293,14303,14321,14323,14327,14341,14347,14369,14387,14389,14401,14407,14411,14419,14423,14431,14437,14447,14449,14461,14479,14489,14503,14519,14533,14537,14543,14549,14551,14557,14561,14563,14591,14593,14621,14627,14629,14633,14639,14653,14657,14669,14683,14699,14713,14717,14723,14731,14737,14741,14747,14753,14759,14767,14771,14779,14783,14797,14813,14821,14827,14831,14843,14851,14867,14869,14879,14887,14891,14897,14923,14929,14939,14947,14951,14957,14969,14983,15013,15017,15031,15053,15061,15073,15077,15083,15091,15101,15107,15121,15131,15137,15139,15149,15161,15173,15187,15193,15199,15217,15227,15233,15241,15259,15263,15269,15271,15277,15287,15289,15299,15307,15313,15319,15329,15331,15349,15359,15361,15373,15377,15383,15391,15401,15413,15427,15439,15443,15451,15461,15467,15473,15493,15497,15511,15527,15541,15551,15559,15569,15581,15583,15601,15607,15619,15629,15641,15643,15647,15649,15661,15667,15671,15679,15683,15727,15731,15733,15737,15739,15749,15761,15767,15773,15787,15791,15797,15803,15809,15817,15823,15859,15877,15881,15887,15889,15901,15907,15913,15919,15923,15937,15959,15971,15973,15991,16001,16007,16033,16057,16061,16063,16067,16069,16073,16087,16091,16097,16103,16111,16127,16139,16141,16183,16187,16189,16193,16217,16223,16229,16231,16249,16253,16267,16273,16301,16319,16333,16339,16349,16361,16363,16369,16381,16411,16417,16421,16427,16433,16447,16451,16453,16477,16481,16487,16493,16519,16529,16547,16553,16561,16567,16573,16603,16607,16619,16631,16633,16649,16651,16657,16661,16673,16691,16693,16699,16703,16729,16741,16747,16759,16763,16787,16811,16823,16829,16831,16843,16871,16879,16883,16889,16901,16903,16921,16927,16931,16937,16943,16963,16979,16981,16987,16993,17011,17021,17027,17029,17033,17041,17047,17053,17077,17093,17099,17107,17117,17123,17137,17159,17167,17183,17189,17191,17203,17207,17209,17231,17239,17257,17291,17293,17299,17317,17321,17327,17333,17341,17351,17359,17377,17383,17387,17389,17393,17401,17417,17419,17431,17443,17449,17467,17471,17477,17483,17489,17491,17497,17509,17519,17539,17551,17569,17573,17579,17581,17597,17599,17609,17623,17627,17657,17659,17669,17681,17683,17707,17713,17729,17737,17747,17749,17761,17783,17789,17791,17807,17827,17837,17839,17851,17863,17881,17891,17903,17909,17911,17921,17923,17929,17939,17957,17959,17971,17977,17981,17987,17989,18013,18041,18043,18047,18049,18059,18061,18077,18089,18097,18119,18121,18127,18131,18133,18143,18149,18169,18181,18191,18199,18211,18217,18223,18229,18233,18251,18253,18257,18269,18287,18289,18301,18307,18311,18313,18329,18341,18353,18367,18371,18379,18397,18401,18413,18427,18433,18439,18443,18451,18457,18461,18481,18493,18503,18517,18521,18523,18539,18541,18553,18583,18587,18593,18617,18637,18661,18671,18679,18691,18701,18713,18719,18731,18743,18749,18757,18773,18787,18793,18797,18803,18839,18859,18869,18899,18911,18913,18917,18919,18947,18959,18973,18979,19001,19009,19013,19031,19037,19051,19069,19073,19079,19081,19087,19121,19139,19141,19157,19163,19181,19183,19207,19211,19213,19219,19231,19237,19249,19259,19267,19273,19289,19301,19309,19319,19333,19373,19379,19381,19387,19391,19403,19417,19421,19423,19427,19429,19433,19441,19447,19457,19463,19469,19471,19477,19483,19489,19501,19507,19531,19541,19543,19553,19559,19571,19577,19583,19597,19603,19609,19661,19681,19687,19697,19699,19709,19717,19727,19739,19751,19753,19759,19763,19777,19793,19801,19813,19819,19841,19843,19853,19861,19867,19889,19891,19913,19919,19927},
	{1000003,1000033,1000037,1000039,1000081,1000099,1000117,1000121,1000133,1000151,1000159,1000171,1000183,1000187,1000193,1000199,1000211,1000213,1000231,1000249,1000253,1000273,1000289,1000291,1000303,1000313,1000333,1000357,1000367,1000381,1000393,1000397,1000403,1000409,1000423,1000427,1000429,1000453,1000457,1000507,1000537,1000541,1000547,1000577,1000579,1000589,1000609,1000619,1000621,1000639,1000651,1000667,1000669,1000679,1000691,1000697,1000721,1000723,1000763,1000777,1000793,1000829,1000847,1000849,1000859,1000861,1000889,1000907,1000919,1000921,1000931,1000969,1000973,1000981,1000999,1001003,1001017,1001023,1001027,1001041,1001069,1001081,1001087,1001089,1001093,1001107,1001123,1001153,1001159,1001173,1001177,1001191,1001197,1001219,1001237,1001267,1001279,1001291,1001303,1001311,1001321,1001323,1001327,1001347,1001353,1001369,1001381,1001387,1001389,1001401,1001411,1001431,1001447,1001459,1001467,1001491,1001501,1001527,1001531,1001549,1001551,1001563,1001569,1001587,1001593,1001621,1001629,1001639,1001659,1001669,1001683,1001687,1001713,1001723,1001743,1001783,1001797,1001801,1001807,1001809,1001821,1001831,1001839,1001911,1001933,1001941,1001947,1001953,1001977,1001981,1001983,1001989,1002017,1002049,1002061,1002073,1002077,1002083,1002091,1002101,1002109,1002121,1002143,1002149,1002151,1002173,1002191,1002227,1002241,1002247,1002257,1002259,1002263,1002289,1002299,1002341,1002343,1002347,1002349,1002359,1002361,1002377,1002403,1002427,1002433,1002451,1002457,1002467,1002481,1002487,1002493,1002503,1002511,1002517,1002523,1002527,1002553,1002569,1002577,1002583,1002619,1002623,1002647,1002653,1002679,1002709,1002713,1002719,1002721,1002739,1002751,1002767,1002769,1002773,1002787,1002797,1002809,1002817,1002821,1002851,1002853,1002857,1002863,1002871,1002887,1002893,1002899,1002913,1002917,1002929,1002931,1002973,1002979,1003001,1003003,1003019,1003039,1003049,1003087,1003091,1003097,1003103,1003109,1003111,1003133,1003141,1003193,1003199,1003201,1003241,1003259,1003273,1003279,1003291,1003307,1003337,1003349,1003351,1003361,1003363,1003367,1003369,1003381,1003397,1003411,1003417,1003433,1003463,1003469,1003507,1003517,1003543,1003549,1003589,1003601,1003609,1003619,1003621,1003627,1003631,1003679,1003693,1003711,1003729,1003733,1003741,1003747,1003753,1003757,1003763,1003771,1003787,1003817,1003819,1003841,1003879,1003889,1003897,1003907,1003909,1003913,1003931,1003943,1003957,1003963,1004027,1004033,1004053,1004057,1004063,1004077,1004089,1004117,1004119,1004137,1004141,1004161,1004167,1004209,1004221,1004233,1004273,1004279,1004287,1004293,1004303,1004317,1004323,1004363,1004371,1004401,1004429,1004441,1004449,1004453,1004461,1004477,1004483,1004501,1004527,1004537,1004551,1004561,1004567,1004599,1004651,1004657,1004659,1004669,1004671,1004677,1004687,1004723,1004737,1004743,1004747,1004749,1004761,1004779,1004797,1004873,1004903,1004911,1004917,1004963,1004977,1004981,1004987,1005007,1005013,1005019,1005029,1005041,1005049,1005071,1005073,1005079,1005101,1005107,1005131,1005133,1005143,1005161,1005187,1005203,1005209,1005217,1005223,1005229,1005239,1005241,1005269,1005287,1005293,1005313,1005317,1005331,1005349,1005359,1005371,1005373,1005391,1005409,1005413,1005427,1005437,1005439,1005457,1005467,1005481,1005493,1005503,1005527,1005541,1005551,1005553,1005581,1005593,1005617,1005619,1005637,1005643,1005647,1005661,1005677,1005679,1005701,1005709,1005751,1005761,1005821,1005827,1005833,1005883,1005911,1005913,1005931,1005937,1005959,1005971,1005989,1006003,1006007,1006021,1006037,1006063,1006087,1006091,1006123,1006133,1006147,1006151,1006153,1006163,1006169,1006171,1006177,1006189,1006193,1006217,1006219,1006231,1006237,1006241,1006249,1006253,1006267,1006279,1006301,1006303,1006307,1006309,1006331,1006333,1006337,1006339,1006351,1006361,1006367,1006391,1006393,1006433,1006441,1006463,1006469,1006471,1006493,1006507,1006513,1006531,1006543,1006547,1006559,1006583,1006589,1006609,1006613,1006633,1006637,1006651,1006711,1006721,1006739,1006751,1006769,1006781,1006783,1006799,1006847,1006853,1006861,1006877,1006879,1006883,1006891,1006897,1006933,1006937,1006949,1006969,1006979,1006987,1006991,1007021,1007023,1007047,1007059,1007081,1007089,1007099,1007117,1007119,1007129,1007137,1007161,1007173,1007179,1007203,1007231,1007243,1007249,1007297,1007299,1007309,1007317,1007339,1007353,1007359,1007381,1007387,1007401,1007417,1007429,1007441,1007459,1007467,1007483,1007497,1007519,1007527,1007549,1007557,1007597,1007599,1007609,1007647,1007651,1007681,1007683,1007693,1007701,1007711,1007719,1007723,1007729,1007731,1007749,1007753,1007759,1007767,1007771,1007789,1007801,1007807,1007813,1007819,1007827,1007857,1007861,1007873,1007887,1007891,1007921,1007933,1007939,1007957,1007959,1007971,1007977,1008001,1008013,1008017,1008031,1008037,1008041,1008043,1008101,1008131,1008157,1008181,1008187,1008193,1008199,1008209,1008223,1008229,1008233,1008239,1008247,1008257,1008263,1008317,1008323,1008331,1008347,1008353,1008373,1008379,1008401,1008407,1008409,1008419,1008421,1008433,1008437,1008451,1008467,1008493,1008499,1008503,1008517,1008541,1008547,1008563,1008571,1008587,1008589,1008607,1008611,1008613,1008617,1008659,1008701,1008719,1008743,1008773,1008779,1008781,1008793,1008809,1008817,1008829,1008851,1008853,1008857,1008859,1008863,1008871,1008901,1008911,1008913,1008923,1008937,1008947,1008979,1008983,1008989,1008991,1009007,1009037,1009049,1009061,1009097,1009121,1009139,1009153,1009157,1009159,1009163,1009189,1009193,1009199,1009201,1009207,1009237,1009243,1009247,1009259,1009289,1009291,1009301,1009303,1009319,1009321,1009343,1009357,1009361,1009369,1009373,1009387,1009399,1009417,1009433,1009439,1009457,1009483,1009487,1009499,1009501,1009507,1009531,1009537,1009559,1009573,1009601,1009609,1009621,1009627,1009637,1009643,1009649,1009651,1009669,1009727,1009741,1009747,1009781,1009787,1009807,1009819,1009837,1009843,1009859,1009873,1009901,1009909,1009927,1009937,1009951,1009963,1009991,1009993,1009997,1010003,1010033,1010069,1010081,1010083,1010129,1010131,1010143,1010167,1010179,1010201,1010203,1010237,1010263,1010291,1010297,1010329,1010353,1010357,1010381,1010407,1010411,1010419,1010423,1010431,1010461,1010467,1010473,1010491,1010501,1010509,1010519,1010549,1010567,1010579,1010617,1010623,1010627,1010671,1010683,1010687,1010717,1010719,1010747,1010749,1010753,1010759,1010767,1010771,1010783,1010791,1010797,1010809,1010833,1010843,1010861,1010881,1010897,1010899,1010903,1010917,1010929,1010957,1010981,1010983,1010993,1011001,1011013,1011029,1011037,1011067,1011071,1011077,1011079,1011091,1011107,1011137,1011139,1011163,1011167,1011191,1011217,1011221,1011229,1011233,1011239,1011271,1011277,1011281,1011289,1011331,1011343,1011349,1011359,1011371,1011377,1011391,1011397,1011407,1011431,1011443,1011509,1011539,1011553,1011559,1011583,1011587,1011589,1011599,1011601,1011631,1011641,1011649,1011667,1011671,1011677,1011697,1011719,1011733,1011737,1011749,1011763,1011779,1011797,1011799,1011817,1011827,1011889,1011893,1011917,1011937,1011943,1011947,1011961,1011973,1011979,1012007,1012009,1012031,1012043,1012049,1012079,1012087,1012093,1012097,1012103,1012133,1012147,1012159,1012171,1012183,1012189,1012201,1012213,1012217,1012229,1012241,1012259,1012261,1012267,1012279,1012289,1012307,1012321,1012369,1012373,1012379,1012397,1012399,1012411,1012421,1012423,1012433,1012439,1012447,1012457,1012463,1012481,1012489,1012507,1012513,1012519,1012523,1012547,1012549,1012559,1012573,1012591,1012597,1012601,1012619,1012631,1012633,1012637,1012657,1012663,1012679,1012691,1012699,1012703,1012717,1012721,1012733,1012751,1012763,1012769,1012771,1012789,1012811,1012829,1012831,1012861,1012903,1012919,1012931,1012967,1012981,1012993,1012997,1013003,1013009,1013029,1013041,1013053,1013063,1013143,1013153,1013197,1013203,1013227,1013237,1013239,1013249,1013263,1013267,1013279,1013291,1013321,1013329,1013377,1013399,1013401,1013429,1013431,1013471,1013477,1013501,1013503,1013527,1013531,1013533,1013563,1013569,1013581,1013603,1013609,1013627,1013629,1013641,1013671,1013681,1013687,1013699,1013711,1013713,1013717,1013729,1013741,1013767,1013773,1013791},
	{100000007,100000037,100000039,100000049,100000073,100000081,100000123,100000127,100000193,100000213,100000217,100000223,100000231,100000237,100000259,100000267,100000279,100000357,100000379,100000393,100000399,100000421,100000429,100000463,100000469,100000471,100000493,100000541,100000543,100000561,100000567,100000577,100000609,100000627,100000643,100000651,100000661,100000669,100000673,100000687,100000717,100000721,100000793,100000799,100000801,100000837,100000841,100000853,100000891,100000921,100000937,100000939,100000963,100000969,100001029,100001053,100001059,100001081,100001087,100001107,100001119,100001131,100001147,100001159,100001177,100001183,100001203,100001207,100001219,100001227,100001303,100001329,100001333,100001347,100001357,100001399,100001431,100001449,100001467,100001507,100001533,100001537,100001569,100001581,100001591,100001611,100001623,100001651,100001653,100001687,100001689,100001719,100001761,100001767,100001777,100001791,100001801,100001809,100001813,100001819,100001821,100001827,100001843,100001887,100001893,100001903,100001927,100001929,100001983,100001987,100002011,100002013,100002017,100002031,100002037,100002059,100002103,100002113,100002127,100002139,100002163,100002167,100002169,100002173,100002181,100002223,100002233,100002251,100002271,100002283,100002289,100002337,100002349,100002389,100002421,100002431,100002437,100002493,100002499,100002503,100002509,100002541,100002569,100002571,100002589,100002593,100002611,100002613,100002629,100002641,100002647,100002671,100002673,100002677,100002737,100002751,100002769,100002797,100002839,100002863,100002899,100002937,100002941,100002943,100002961,100002967,100002979,100003021,100003037,100003063,100003091,100003151,100003153,100003157,100003181,100003219,100003243,100003247,100003259,100003273,100003279,100003283,100003291,100003301,100003313,100003331,100003349,100003361,100003381,100003417,100003447,100003481,100003499,100003549,100003559,100003573,100003601,100003619,100003621,100003679,100003691,100003699,100003703,100003721,100003753,100003759,100003763,100003777,100003789,100003801,100003807,100003811,100003823,100003829,100003831,100003867,100003873,100003901,100003913,100003927,100003957,100003963,100004017,100004027,100004029,100004041,100004059,100004089,100004119,100004137,100004141,100004143,100004153,100004159,100004167,100004189,100004243,100004263,100004287,100004291,100004309,100004327,100004347,100004363,100004389,100004393,100004407,100004417,100004449,100004461,100004473,100004477,100004501,100004503,100004507,100004519,100004521,100004533,100004537,100004549,100004551,100004561,100004563,100004629,100004647,100004651,100004677,100004719,100004741,100004813,100004819,100004831,100004833,100004857,100004881,100004893,100004909,100004929,100004981,100005001,100005023,100005029,100005041,100005083,100005091,100005097,100005107,100005121,100005131,100005149,100005193,100005197,100005239,100005259,100005263,100005281,100005307,100005313,100005317,100005319,100005343,100005377,100005383,100005391,100005397,100005421,100005431,100005439,100005443,100005457,100005461,100005463,100005467,100005469,100005523,100005527,100005533,100005539,100005551,100005583,100005599,100005617,100005623,100005637,100005641,100005667,100005673,100005727,100005743,100005749,100005757,100005809,100005821,100005853,100005877,100005889,100005923,100005943,100005973,100005991,100006033,100006037,100006043,100006061,100006091,100006097,100006103,100006111,100006117,100006129,100006133,100006157,100006169,100006187,100006199,100006211,100006213,100006229,100006237,100006241,100006273,100006327,100006343,100006381,100006391,100006397,100006457,100006477,100006483,100006493,100006547,100006549,100006561,100006567,100006583,100006607,100006609,100006637,100006639,100006661,100006693,100006721,100006729,100006757,100006759,100006769,100006771,100006787,100006789,100006799,100006817,100006891,100006901,100006927,100006939,100006957,100006981,100007009,100007071,100007093,100007099,100007101,100007111,100007119,100007137,100007143,100007177,100007179,100007191,100007213,100007221,100007227,100007231,100007233,100007267,100007329,100007351,100007353,100007359,100007363,100007377,100007407,100007423,100007461,100007489,100007503,100007527,100007543,100007563,100007623,100007647,100007701,100007741,100007797,100007807,100007813,100007819,100007833,100007839,100007851,100007857,100007861,100007879,100007893,100007903,100007909,100007911,100007927,100007939,100007951,100007983,100007987,100007989,100008023,100008043,100008091,100008109,100008113,100008119,100008133,100008169,100008199,100008217,100008221,100008241,100008247,100008253,100008313,100008317,100008319,100008323,100008367,100008371,100008397,100008401,100008409,100008427,100008479,100008589,100008593,100008611,100008619,100008653,100008661,100008673,100008703,100008737,100008749,100008757,100008763,100008781,100008787,100008803,100008851,100008863,100008869,100008871,100008889,100008893,100008929,100009009,100009043,100009057,100009067,100009093,100009097,100009153,100009201,100009213,100009243,100009297,100009303,100009309,100009321,100009337,100009361,100009363,100009387,100009391,100009421,100009433,100009477,100009499,100009501,100009517,100009549,100009573,100009607,100009621,100009649,100009669,100009699,100009703,100009729,100009733,100009739,100009747,100009753,100009757,100009769,100009817,100009823,100009831,100009837,100009841,100009849,100009883,100009913,100009933,100009969,100009979,100010017,100010021,100010023,100010033,100010039,100010047,100010051,100010059,100010077,100010107,100010143,100010161,100010173,100010177,100010179,100010189,100010191,100010203,100010227,100010231,100010237,100010257,100010263,100010321,100010327,100010329,100010347,100010353,100010359,100010401,100010419,100010423,100010437,100010441,100010461,100010489,100010497,100010527,100010539,100010549,100010551,100010567,100010597,100010621,100010627,100010633,100010663,100010683,100010717,100010731,100010749,100010759,100010777,100010791,100010843,100010857,100010861,100010887,100010951,100010957,100010993,100011029,100011031,100011047,100011073,100011089,100011091,100011113,100011137,100011161,100011167,100011181,100011203,100011217,100011271,100011277,100011287,100011349,100011361,100011397,100011413,100011419,100011437,100011449,100011451,100011467,100011469,100011479,100011491,100011547,100011599,100011619,100011623,100011643,100011677,100011683,100011713,100011727,100011733,100011739,100011761,100011767,100011787,100011811,100011829,100011841,100011853,100011869,100011871,100011907,100011913,100011931,100011943,100011959,100011973,100011979,100012019,100012049,100012057,100012063,100012069,100012103,100012111,100012153,100012163,100012189,100012217,100012223,100012247,100012259,100012267,100012273,100012277,100012291,100012301,100012337,100012351,100012379,100012391,100012397,100012421,100012457,100012463,100012469,100012481,100012519,100012543,100012573,100012589,100012597,100012607,100012609,100012621,100012651,100012667,100012669,100012673,100012681,100012697,100012721,100012753,100012777,100012799,100012807,100012837,100012859,100012873,100012889,100012919,100012931,100012951,100012963,100012987,100013021,100013027,100013071,100013087,100013113,100013143,100013149,100013167,100013197,100013213,100013237,100013273,100013281,100013293,100013297,100013311,100013327,100013341,100013351,100013357,100013371,100013387,100013443,100013449,100013467,100013477,100013497,100013519,100013527,100013531,100013561,100013579,100013593,100013611,100013623,100013633,100013707,100013741,100013747,100013759,100013761,100013803,100013827,100013861,100013899,100013911,100013987,100013989,100013999,100014037,100014041,100014053,100014059,100014067,100014193,100014203,100014209,100014227,100014251,100014287,100014289,100014311,100014331,100014353,100014361,100014389,100014391,100014403,100014407,100014413,100014427,100014433,100014437,100014479,100014493,100014547,100014559,100014583,100014643,100014653,100014683,100014697,100014709,100014743,100014829,100014839,100014847,100014877,100014911,100014923,100014977,100014983,100015009,100015039,100015043,100015079,100015099,100015129,100015133,100015141,100015159,100015169,100015177,100015189,100015213,100015219,100015231,100015273,100015309,100015367,100015379,100015387,100015427,100015429,100015469,100015493,100015537,100015543,100015547,100015567,100015583,100015589,100015613,100015627,100015631,100015673,100015681,100015691,100015739,100015757,100015759,100015763,100015787,100015793,100015801,100015819,100015831,100015837,100015841,100015873,100015897,100015901,100015939,100015963,100015969,100015991,100016009,100016023,100016039,100016051,100016087,100016107,100016123,100016129,100016131,100016177,100016201,100016207,100016227,100016233,100016239,100016249,100016263,100016299,100016339,100016359,100016369,100016377,100016381,100016383,100016407,100016417,100016419,100016453,100016473,100016479,100016531,100016537,100016561,100016569,100016573,100016597,100016599,100016641,100016659,100016669,100016677,100016689,100016717,100016747,100016771,100016773,100016783,100016821,100016849,100016869,100016879,100016887,100016921,100016927,100016941,100016993,100017013,100017037,100017053,100017077,100017079,100017119,100017149,100017167,100017193,100017217,100017263,100017283,100017319,100017329,100017403,100017431,100017473,100017493,100017499,100017517,100017553,100017557,100017559,100017569,100017571,100017581,100017641,100017661,100017677,100017683,100017689,100017733,100017761,100017763,100017791,100017793,100017829,100017847,100017887,100017947,100017959,100017971,100017989,100018001,100018003,100018019,100018031,100018057,100018081,100018091,100018097,100018151,100018189,100018199,100018213,100018231,100018273,100018277,100018313,100018319,100018351,100018379,100018409,100018411,100018417,100018433,100018441,100018547,100018561,100018573,100018591,100018613,100018619,100018621,100018627,100018643,100018663,100018669,100018691,100018693,100018703,100018729,100018753,100018757,100018771,100018777,100018781,100018799,100018801,100018811,100018813,100018829,100018843,100018879,100018909,100018913,100018921,100018951},
	{1000000007,1000000009,1000000021,1000000033,1000000087,1000000093,1000000097,1000000103,1000000123,1000000181,1000000207,1000000223,1000000241,1000000271,1000000289,1000000297,1000000321,1000000349,1000000363,1000000403,1000000409,1000000411,1000000427,1000000433,1000000439,1000000447,1000000453,1000000459,1000000483,1000000513,1000000531,1000000579,1000000607,1000000613,1000000637,1000000663,1000000711,1000000753,1000000787,1000000801,1000000829,1000000861,1000000871,1000000891,1000000901,1000000919,1000000931,1000000933,1000000993,1000001011,1000001021,1000001053,1000001087,1000001099,1000001137,1000001161,1000001203,1000001213,1000001237,1000001263,1000001269,1000001273,1000001279,1000001311,1000001329,1000001333,1000001351,1000001371,1000001393,1000001413,1000001447,1000001449,1000001491,1000001501,1000001531,1000001537,1000001539,1000001581,1000001617,1000001621,1000001633,1000001647,1000001663,1000001677,1000001699,1000001759,1000001773,1000001789,1000001791,1000001801,1000001803,1000001819,1000001857,1000001887,1000001917,1000001927,1000001957,1000001963,1000001969,1000002043,1000002089,1000002103,1000002139,1000002149,1000002161,1000002173,1000002187,1000002193,1000002233,1000002239,1000002277,1000002307,1000002359,1000002361,1000002431,1000002449,1000002457,1000002499,1000002571,1000002581,1000002607,1000002631,1000002637,1000002649,1000002667,1000002727,1000002791,1000002803,1000002821,1000002823,1000002827,1000002907,1000002937,1000002989,1000003009,1000003013,1000003051,1000003057,1000003097,1000003111,1000003133,1000003153,1000003157,1000003163,1000003211,1000003241,1000003247,1000003253,1000003267,1000003271,1000003273,1000003283,1000003309,1000003337,1000003351,1000003357,1000003373,1000003379,1000003397,1000003469,1000003471,1000003513,1000003519,1000003559,1000003577,1000003579,1000003601,1000003621,1000003643,1000003651,1000003663,1000003679,1000003709,1000003747,1000003751,1000003769,1000003777,1000003787,1000003793,1000003843,1000003853,1000003871,1000003889,1000003891,1000003909,1000003919,1000003931,1000003951,1000003957,1000003967,1000003987,1000003999,1000004023,1000004059,1000004099,1000004119,1000004123,1000004207,1000004233,1000004249,1000004251,1000004263,1000004321,1000004329,1000004381,1000004389,1000004437,1000004449,1000004459,1000004497,1000004507,1000004519,1000004539,1000004567,1000004569,1000004581,1000004609,1000004611,1000004627,1000004633,1000004647,1000004693,1000004699,1000004717,1000004771,1000004777,1000004783,1000004791,1000004807,1000004839,1000004843,1000004849,1000004857,1000004867,1000004869,1000004891,1000004893,1000004897,1000004927,1000004933,1000004977,1000004981,1000005001,1000005029,1000005053,1000005067,1000005103,1000005133,1000005187,1000005197,1000005203,1000005233,1000005277,1000005287,1000005299,1000005317,1000005329,1000005341,1000005353,1000005361,1000005403,1000005407,1000005437,1000005443,1000005449,1000005451,1000005469,1000005491,1000005527,1000005541,1000005547,1000005583,1000005631,1000005647,1000005683,1000005731,1000005737,1000005751,1000005763,1000005791,1000005823,1000005827,1000005833,1000005847,1000005863,1000005899,1000005907,1000005947,1000005953,1000005959,1000005971,1000005973,1000005991,1000005997,1000006019,1000006027,1000006037,1000006039,1000006061,1000006093,1000006099,1000006127,1000006129,1000006177,1000006193,1000006211,1000006223,1000006229,1000006307,1000006313,1000006331,1000006349,1000006379,1000006393,1000006417,1000006421,1000006457,1000006459,1000006477,1000006541,1000006571,1000006577,1000006583,1000006607,1000006621,1000006661,1000006663,1000006697,1000006717,1000006751,1000006781,1000006837,1000006867,1000006901,1000006957,1000006961,1000006967,1000006981,1000007003,1000007023,1000007027,1000007089,1000007117,1000007137,1000007147,1000007159,1000007191,1000007209,1000007237,1000007243,1000007257,1000007279,1000007321,1000007347,1000007383,1000007389,1000007417,1000007429,1000007447,1000007453,1000007467,1000007479,1000007497,1000007513,1000007521,1000007531,1000007537,1000007557,1000007633,1000007647,1000007651,1000007653,1000007681,1000007707,1000007719,1000007741,1000007759,1000007773,1000007803,1000007819,1000007837,1000007873,1000007887,1000007909,1000007923,1000007927,1000007929,1000007941,1000008041,1000008083,1000008089,1000008101,1000008109,1000008127,1000008173,1000008181,1000008223,1000008257,1000008259,1000008271,1000008277,1000008311,1000008313,1000008343,1000008349,1000008397,1000008403,1000008419,1000008431,1000008439,1000008487,1000008511,1000008557,1000008593,1000008617,1000008637,1000008649,1000008661,1000008671,1000008679,1000008719,1000008727,1000008761,1000008773,1000008791,1000008797,1000008803,1000008811,1000008829,1000008853,1000008899,1000008917,1000008937,1000008967,1000009009,1000009013,1000009063,1000009081,1000009093,1000009099,1000009123,1000009133,1000009163,1000009183,1000009211,1000009223,1000009259,1000009277,1000009279,1000009289,1000009301,1000009321,1000009331,1000009363,1000009399,1000009403,1000009421,1000009441,1000009457,1000009469,1000009487,1000009519,1000009529,1000009531,1000009541,1000009559,1000009561,1000009567,1000009573,1000009579,1000009597,1000009601,1000009609,1000009631,1000009651,1000009667,1000009679,1000009711,1000009733,1000009739,1000009757,1000009789,1000009831,1000009859,1000009867,1000009961,1000009999,1000010029,1000010051,1000010069,1000010101,1000010153,1000010173,1000010189,1000010197,1000010233,1000010243,1000010251,1000010267,1000010281,1000010303,1000010321,1000010327,1000010351,1000010357,1000010381,1000010449,1000010467,1000010483,1000010503,1000010513,1000010549,1000010593,1000010597,1000010611,1000010633,1000010659,1000010699,1000010707,1000010723,1000010747,1000010749,1000010761,1000010773,1000010777,1000010801,1000010833,1000010903,1000010953,1000010969,1000010971,1000010981,1000010987,1000011007,1000011011,1000011071,1000011083,1000011091,1000011107,1000011109,1000011137,1000011149,1000011161,1000011223,1000011239,1000011253,1000011269,1000011277,1000011283,1000011289,1000011301,1000011317,1000011329,1000011371,1000011377,1000011391,1000011421,1000011479,1000011487,1000011497,1000011517,1000011533,1000011539,1000011559,1000011583,1000011601,1000011619,1000011631,1000011659,1000011673,1000011679,1000011707,1000011763,1000011767,1000011769,1000011773,1000011799,1000011811,1000011821,1000011823,1000011847,1000011869,1000011967,1000011983,1000011989,1000012019,1000012037,1000012121,1000012157,1000012177,1000012187,1000012217,1000012219,1000012231,1000012241,1000012253,1000012297,1000012309,1000012333,1000012337,1000012339,1000012361,1000012367,1000012399,1000012411,1000012459,1000012463,1000012483,1000012501,1000012513,1000012523,1000012547,1000012553,1000012577,1000012609,1000012631,1000012649,1000012679,1000012681,1000012703,1000012723,1000012733,1000012747,1000012753,1000012759,1000012799,1000012847,1000012877,1000012891,1000012901,1000012903,1000012927,1000012939,1000012963,1000013011,1000013017,1000013029,1000013039,1000013081,1000013087,1000013089,1000013101,1000013107,1000013137,1000013141,1000013143,1000013153,1000013191,1000013207,1000013213,1000013237,1000013323,1000013369,1000013419,1000013437,1000013447,1000013477,1000013519,1000013537,1000013561,1000013563,1000013587,1000013591,1000013723,1000013741,1000013759,1000013789,1000013801,1000013857,1000013881,1000013897,1000013921,1000013923,1000013939,1000013999,1000014011,1000014073,1000014077,1000014083,1000014097,1000014121,1000014131,1000014143,1000014157,1000014161,1000014167,1000014181,1000014193,1000014209,1000014241,1000014259,1000014271,1000014293,1000014361,1000014391,1000014397,1000014437,1000014529,1000014551,1000014581,1000014583,1000014599,1000014607,1000014611,1000014643,1000014727,1000014761,1000014773,1000014779,1000014791,1000014823,1000014853,1000014881,1000014889,1000014901,1000014931,1000014937,1000014997,1000015031,1000015043,1000015057,1000015063,1000015069,1000015097,1000015103,1000015109,1000015117,1000015141,1000015147,1000015187,1000015199,1000015217,1000015231,1000015253,1000015271,1000015279,1000015283,1000015307,1000015339,1000015349,1000015351,1000015363,1000015369,1000015409,1000015427,1000015447,1000015477,1000015487,1000015553,1000015579,1000015591,1000015649,1000015651,1000015673,1000015693,1000015703,1000015717,1000015727,1000015747,1000015799,1000015811,1000015823,1000015859,1000015889,1000015963,1000015981,1000016009,1000016021,1000016029,1000016047,1000016063,1000016089,1000016093,1000016107,1000016153,1000016167,1000016191,1000016201,1000016231,1000016233,1000016261,1000016267,1000016273,1000016317,1000016323,1000016411,1000016419,1000016431,1000016489,1000016491,1000016513,1000016539,1000016617,1000016621,1000016623,1000016627,1000016651,1000016659,1000016671,1000016711,1000016863,1000016887,1000016909,1000016929,1000016939,1000017047,1000017071,1000017077,1000017089,1000017097,1000017107,1000017119,1000017131,1000017157,1000017169,1000017199,1000017203,1000017223,1000017229,1000017247,1000017257,1000017259,1000017287,1000017289,1000017301,1000017307,1000017311,1000017349,1000017379,1000017413,1000017433,1000017493,1000017541,1000017559,1000017563,1000017607,1000017631,1000017659,1000017737,1000017751,1000017769,1000017773,1000017793,1000017797,1000017829,1000017841,1000017853,1000017869,1000017881,1000017923,1000017929,1000017959,1000017961,1000018001,1000018007,1000018067,1000018073,1000018087,1000018093,1000018141,1000018147,1000018169,1000018171,1000018189,1000018321,1000018333,1000018337,1000018361,1000018373,1000018379,1000018381,1000018391,1000018427,1000018433,1000018441,1000018471,1000018477,1000018519,1000018531,1000018543,1000018549,1000018601,1000018603,1000018619,1000018627,1000018651,1000018709,1000018711,1000018753,1000018757,1000018813,1000018819,1000018841,1000018847,1000018871,1000018913,1000018927,1000018939,1000018967,1000018969,1000019003,1000019057,1000019071,1000019081,1000019089,1000019099,1000019107,1000019113,1000019117,1000019123,1000019131,1000019159,1000019161,1000019227,1000019249,1000019257,1000019327,1000019333,1000019351,1000019353,1000019357,1000019393,1000019399,1000019401,1000019429,1000019443,1000019459,1000019467,1000019491,1000019563,1000019569,1000019591,1000019597,1000019617,1000019621,1000019659,1000019677,1000019681,1000019693,1000019707,1000019711,1000019719,1000019743,1000019767,1000019777,1000019791,1000019803,1000019819,1000019857,1000019861,1000019863,1000019869,1000019873,1000019897,1000019899,1000019903,1000019927,1000019981,1000020001,1000020011,1000020023,1000020029,1000020107,1000020139,1000020163,1000020193,1000020209,1000020221,1000020283,1000020313,1000020319,1000020337,1000020347,1000020353,1000020361,1000020367,1000020383,1000020409,1000020443,1000020491,1000020523,1000020547,1000020569,1000020577,1000020689,1000020701,1000020727,1000020737,1000020743,1000020757,1000020779,1000020799,1000020803,1000020817,1000020829,1000020851,1000020881,1000020893,1000020919,1000020929,1000020953,1000020961,1000020991,1000020997,1000021003,1000021019,1000021027,1000021069,1000021079,1000021081,1000021097,1000021133,1000021189,1000021193,1000021229,1000021247,1000021259,1000021261,1000021273,1000021291,1000021333,1000021339,1000021369,1000021409}
};

string s,good;
int k,n;
int bad[1510];

const int B=4;
ll base[B];
ll hash[B][1510];
ll pw[B][1510];

pair<ll,pair<ll,pair<ll,ll> > > S[1130010];

ll ind=0;

int main(){
	cin.tie(0);
	ios_base::sync_with_stdio(0);
	srand(time(NULL));
	
	cin>>s>>good>>k;
	n=sz(s);
	
	rep(i,B){
		base[i]=primes[i][rand()&1023];
		pw[i][0]=1;
		rep(j,n)pw[i][j+1]=pw[i][j]*base[i];
	}
	rep(i,B){
		hash[i][0]=0;
		rep(j,n){
			hash[i][j+1]=hash[i][j]*base[i]+s[j];
		}
	}
	bad[0]=0;
	rep(i,n){
		bad[i+1]=bad[i]+(good[s[i]-'a']=='0');
	}
	
	rep(i,n)rep2(j,i,n){
		if(bad[j+1]-bad[i]<=k){
			S[ind++]=
				mp(hash[0][j+1] - hash[0][i]*pw[0][j+1-i],
				mp(hash[1][j+1] - hash[1][i]*pw[1][j+1-i],
				mp(hash[2][j+1] - hash[2][i]*pw[2][j+1-i],
				hash[3][j+1] - hash[3][i]*pw[3][j+1-i])));
		}
	}
	sort(S,S+ind);
	cout<<unique(S,S+ind)-S;
}
