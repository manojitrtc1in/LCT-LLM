#include<iostream>
#include<cstdlib>
#include<cstring>
#include<algorithm>
#include<cmath>
#include<stdio.h>
#include<vector>
#include<map>
using namespace std;

#define o2AKRXfU )
#define SN5e8jTMdl9 }
#define kjuisdfnmn int
#define KXcbdsuioWEisodufb asduyrefgdf
#define djksfuoiu cout
#define saduoiopnsdfsd djksfuoiu
#define waZ5UsI2a5w ]
#define ECLBXHaE1wcnJTQ8lwhlM [
#define ldl8kZFzzYbJI1v5X TvywQ9X6LEQ
#define XI9Zjdj4IndSo9kfeh ECLBXHaE1wcnJTQ8lwhlM
#define sdjkhfjdshf324 for
#define zQ8kn177iMP6 XI9Zjdj4IndSo9kfeh
#define jWEH5wdkwIL2DbhCh9DRnXv nRYlYOCcMbQ
#define iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh eriukjjkkdjfgjhgyuyudsif
#define aEG4xFeHp5LT Gw0M7M
#define xcRQbFu HW5nBn
#define MjQWhJU2WyDQtLasvquD+eSP o2AKRXfU
#define e1EKk4nLeC4zzXb7 o2AKRXfU
#define jmsdfkWQEr22FSD234SDFFwasd ASDFasd1dfdsfsdf
#define ZPokVjqwsadLasdhjysad sdufuioiovxcmvnusd
#define ASDFasd1dfdsfsdf dsjhfucheSDFsdfsdf
#define sdfoiuin uiooqwuyyfjsdh
#define dsjfhjkiu jhdsfuyhuhbbnsdDesdF
#define asdhjsajdhubasd if
#define jhdsfuiiiuoiasdids dsjfhjkiu
#define KlopQXZvnuiuasdbbnbdsaioqw jhdsfuiiiuoiasdids
#define TvywQ9X6LEQ SN5e8jTMdl9
#define uiooqwuyyfjsdh asduiyhooXCVASwj
#define jhdsfuyhuhbbnsdDesdF ==
#define UIMNyJOKoeKNUbo {
#define D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc ldl8kZFzzYbJI1v5X
#define JDDUobOmXqpDbWPXcxt4oo44Inle c1ao3qn8KLtbB
#define uyuiuoqwMSDFiuyfdsFDS sdfoiuin
#define UHJHJdgsyduiyuiyu234r sdjkhfjdshf324
#define c1ao3qn8KLtbB Gw0M7M
#define eriukjjkkdjfgjhgyuyudsif UHJHJdgsyduiyuiyu234r
#define asduiyhooXCVASwj main
#define dsjhfucheSDFsdfsdf asdhjsajdhubasd
#define sdufuioiovxcmvnusd saduoiopnsdfsd
#define jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI e1EKk4nLeC4zzXb7
#define Gw0M7M (
#define jkpoasduihnfdsfnm kjuisdfnmn
#define asduyrefgdf jkpoasduihnfdsfnm
#define nRYlYOCcMbQ MbQxACtS3KCt
#define MbQxACtS3KCt UIMNyJOKoeKNUbo
#define HW5nBn waZ5UsI2a5w
int cnt_list,pos zQ8kn177iMP6 20200 xcRQbFu ,pa zQ8kn177iMP6 20100 xcRQbFu ,len zQ8kn177iMP6 20100 xcRQbFu ,fs zQ8kn177iMP6 20100 xcRQbFu ,pc zQ8kn177iMP6 20100 xcRQbFu ,ls zQ8kn177iMP6 20100 xcRQbFu ,cnt_ls,tmp zQ8kn177iMP6 20100 xcRQbFu ,cnt,n,num_q;
struct pp
 jWEH5wdkwIL2DbhCh9DRnXv 
	int id;
	char ch;
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc ;
vector<pp>adj zQ8kn177iMP6 20201 xcRQbFu ;
pp now;
void dfs JDDUobOmXqpDbWPXcxt4oo44Inle int id,int pr jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int i,j,s,p,q,ip;
	pos zQ8kn177iMP6 id xcRQbFu =cnt_list++;
	pa zQ8kn177iMP6 pos zQ8kn177iMP6 id xcRQbFu  xcRQbFu =pr;
	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<adj zQ8kn177iMP6 id xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		ip=adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu .id;
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle pos zQ8kn177iMP6 ip xcRQbFu >=0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		   continue;
        pc zQ8kn177iMP6 cnt_list xcRQbFu =adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu .ch-'a';
        dfs JDDUobOmXqpDbWPXcxt4oo44Inle ip,pos zQ8kn177iMP6 id xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
int main JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int id1,id2,i,j,s,p,q,x,y,fg;
	char ch;
	scanf JDDUobOmXqpDbWPXcxt4oo44Inle "%d%d",&n,&num_q jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<n-1;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		scanf JDDUobOmXqpDbWPXcxt4oo44Inle "%d%d",&id1,&id2 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
		ch=getchar JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
		while JDDUobOmXqpDbWPXcxt4oo44Inle ch<'a'||ch>'z' jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		   ch=getchar JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
		id1--;
		id2--;
		now.id=id2;
		now.ch=ch;
		adj zQ8kn177iMP6 id1 xcRQbFu .push_back JDDUobOmXqpDbWPXcxt4oo44Inle now jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
		now.id=id1;
		now.ch=ch;
		adj zQ8kn177iMP6 id2 xcRQbFu .push_back JDDUobOmXqpDbWPXcxt4oo44Inle now jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
    memset JDDUobOmXqpDbWPXcxt4oo44Inle pos,-1,sizeof JDDUobOmXqpDbWPXcxt4oo44Inle pos jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    dfs JDDUobOmXqpDbWPXcxt4oo44Inle 0,-1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    while JDDUobOmXqpDbWPXcxt4oo44Inle num_q-- jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
     jWEH5wdkwIL2DbhCh9DRnXv 
    	scanf JDDUobOmXqpDbWPXcxt4oo44Inle "%d%d",&x,&y jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    	x--;
    	y--;
 	    x=pos zQ8kn177iMP6 x xcRQbFu ;
 	    y=pos zQ8kn177iMP6 y xcRQbFu ; 
    	int u,v;
		u=x;
    	v=y;
    	cnt_ls=cnt=0;
    	while JDDUobOmXqpDbWPXcxt4oo44Inle u!=v jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
    	 jWEH5wdkwIL2DbhCh9DRnXv 
	    	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle u>v jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	    	 jWEH5wdkwIL2DbhCh9DRnXv 
	    		ls zQ8kn177iMP6 cnt_ls++ xcRQbFu =pc zQ8kn177iMP6 u xcRQbFu ;
	    		u=pa zQ8kn177iMP6 u xcRQbFu ;
	    	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	    	else
	    	 jWEH5wdkwIL2DbhCh9DRnXv 
	    		tmp zQ8kn177iMP6 cnt++ xcRQbFu =pc zQ8kn177iMP6 v xcRQbFu ;
	    		v=pa zQ8kn177iMP6 v xcRQbFu ;
	    	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	    while JDDUobOmXqpDbWPXcxt4oo44Inle cnt>0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
    		ls zQ8kn177iMP6 cnt_ls++ xcRQbFu =tmp zQ8kn177iMP6 --cnt xcRQbFu ;
		 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<n;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
    	   len zQ8kn177iMP6 i xcRQbFu =-1;
 	    u=x;
 	    fs zQ8kn177iMP6 u xcRQbFu =len zQ8kn177iMP6 u xcRQbFu =0;
	    int ans=0;
		while JDDUobOmXqpDbWPXcxt4oo44Inle u!=0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 	     jWEH5wdkwIL2DbhCh9DRnXv 
 	    	len zQ8kn177iMP6 pa zQ8kn177iMP6 u xcRQbFu  xcRQbFu =len zQ8kn177iMP6 u xcRQbFu +1;
	    	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle fs zQ8kn177iMP6 u xcRQbFu  KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	    	 jWEH5wdkwIL2DbhCh9DRnXv 
	    		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle len zQ8kn177iMP6 u xcRQbFu <cnt_ls jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	    		 jWEH5wdkwIL2DbhCh9DRnXv 
		    		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ls zQ8kn177iMP6 len zQ8kn177iMP6 u xcRQbFu  xcRQbFu >pc zQ8kn177iMP6 u xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		    		   fs zQ8kn177iMP6 pa zQ8kn177iMP6 u xcRQbFu  xcRQbFu =-1;
   		            else  jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ls zQ8kn177iMP6 len zQ8kn177iMP6 u xcRQbFu  xcRQbFu <pc zQ8kn177iMP6 u xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
   		               fs zQ8kn177iMP6 pa zQ8kn177iMP6 u xcRQbFu  xcRQbFu =1;
                    else
                       fs zQ8kn177iMP6 pa zQ8kn177iMP6 u xcRQbFu  xcRQbFu =0;
		    	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
		    	else
		    	    fs zQ8kn177iMP6 pa zQ8kn177iMP6 u xcRQbFu  xcRQbFu =1;
	    	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	    	else
	    	   fs zQ8kn177iMP6 pa zQ8kn177iMP6 u xcRQbFu  xcRQbFu =fs zQ8kn177iMP6 u xcRQbFu ;
  	         jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle fs zQ8kn177iMP6 pa zQ8kn177iMP6 u xcRQbFu  xcRQbFu <0|| JDDUobOmXqpDbWPXcxt4oo44Inle fs zQ8kn177iMP6 pa zQ8kn177iMP6 u xcRQbFu  xcRQbFu  KlopQXZvnuiuasdbbnbdsaioqw 0&&len zQ8kn177iMP6 pa zQ8kn177iMP6 u xcRQbFu  xcRQbFu !=cnt_ls jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
  	             ans++;
   	        u=pa zQ8kn177iMP6 u xcRQbFu ;
	    D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	    iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=1;i<n;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	    jWEH5wdkwIL2DbhCh9DRnXv 
   		    jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle len zQ8kn177iMP6 pa zQ8kn177iMP6 i xcRQbFu  xcRQbFu >=0&&len zQ8kn177iMP6 i xcRQbFu <0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
   		    jWEH5wdkwIL2DbhCh9DRnXv 
   		   	    len zQ8kn177iMP6 i xcRQbFu =len zQ8kn177iMP6 pa zQ8kn177iMP6 i xcRQbFu  xcRQbFu +1;
   		   	     jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle fs zQ8kn177iMP6 pa zQ8kn177iMP6 i xcRQbFu  xcRQbFu  KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
   		   	     jWEH5wdkwIL2DbhCh9DRnXv 
   		   	    	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle len zQ8kn177iMP6 pa zQ8kn177iMP6 i xcRQbFu  xcRQbFu <cnt_ls jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
   		   	    	 jWEH5wdkwIL2DbhCh9DRnXv 
    	   		   	    jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ls zQ8kn177iMP6 len zQ8kn177iMP6 pa zQ8kn177iMP6 i xcRQbFu  xcRQbFu  xcRQbFu >pc zQ8kn177iMP6 i xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
    	   		   	       fs zQ8kn177iMP6 i xcRQbFu =-1;
	   		   	       else  jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ls zQ8kn177iMP6 len zQ8kn177iMP6 pa zQ8kn177iMP6 i xcRQbFu  xcRQbFu  xcRQbFu <pc zQ8kn177iMP6 i xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	   		   	           fs zQ8kn177iMP6 i xcRQbFu =1;
		   	           else
		   	               fs zQ8kn177iMP6 i xcRQbFu =0;
   		   	    	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
   		   	    	else
   		   	    	   fs zQ8kn177iMP6 i xcRQbFu =1;
				 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
				else
				    fs zQ8kn177iMP6 i xcRQbFu =fs zQ8kn177iMP6 pa zQ8kn177iMP6 i xcRQbFu  xcRQbFu ;
                 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle fs zQ8kn177iMP6 i xcRQbFu <0|| JDDUobOmXqpDbWPXcxt4oo44Inle fs zQ8kn177iMP6 i xcRQbFu  KlopQXZvnuiuasdbbnbdsaioqw 0&&len zQ8kn177iMP6 i xcRQbFu !=cnt_ls jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
                    ans++;
   		    D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
   	    D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
   	   printf JDDUobOmXqpDbWPXcxt4oo44Inle "%d\n",ans jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	return 0;
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 