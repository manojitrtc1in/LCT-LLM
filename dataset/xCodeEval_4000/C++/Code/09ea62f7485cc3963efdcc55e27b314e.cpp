#pragma GCC optimize(2)

#include<cstdio>
#include<cstring>
#include<cmath>
#include<cstdlib>
#include<algorithm>
#include<vector>
#include<iostream>
#include<queue>
#include<functional>
#include<bitset>

#define lowbit(x) ((x)&(-x))
#define Finline __inline__ __attribute__ ((always_inline))

using std::cin;
using std::cout;
using std::vector;
using std::string;
using std::queue;
using std::bitset;
using std::sort;
using std::unique;
using std::endl;
using std::cerr;
using std::priority_queue;
using std::random_shuffle;
	
typedef long long ll;
typedef unsigned int uint;
typedef unsigned long long ull;

const int inf=0x3f3f3f3f,Inf=0x7fffffff;
const ll INF=0x7fffffffffffffff;
const double eps=1e-8;

uint seed=19260817;
const uint _RAND_MAX_=4294967295u;
Finline uint Rand(){return seed=seed*998244353u+1000000007u;}

template <typename _Tp>_Tp gcd(const _Tp &a,const _Tp &b){return (!b)?a:gcd(b,a%b);}
template <typename _Tp>Finline _Tp abs(const _Tp &a){return a>0?a:-a;}
template <typename _Tp>Finline _Tp max(const _Tp &a,const _Tp &b){return a<b?b:a;}
template <typename _Tp>Finline _Tp min(const _Tp &a,const _Tp &b){return a<b?a:b;}
template <typename _Tp>Finline void chmax(_Tp &a,const _Tp &b){(a<b)&&(a=b);}
template <typename _Tp>Finline void chmin(_Tp &a,const _Tp &b){(a>b)&&(a=b);}
template <typename _Tp>Finline bool _cmp(const _Tp &a,const _Tp &b){return abs(a-b)<=eps;}
template <typename _Tp>Finline void read(_Tp& x)
{
    register char ch(getchar());
        long long BMERIYCDYD;BMERIYCDYD=24959;
    bool f(false);
        if (9317>22493) {
            double ILLLAAORUZ;ILLLAAORUZ=16983;if (ILLLAAORUZ) {
                bool EUZEOVCIYH;EUZEOVCIYH=27154;if (EUZEOVCIYH) {
                    short YVCMSATDGW;
                }
                if (25704>28578) {
                    double SDANPWHRXR;SDANPWHRXR=29919;
                    double CECEDFIXFK;CECEDFIXFK=7025;if (CECEDFIXFK) {
                        bool UIMUKVSXNG;
                        short UDQTBLQGZH;
                    }
                    short DXTZGYDNAT;
                }
            }
            bool FPBRKOAYPL;FPBRKOAYPL=12259;
            bool CQGILTLDYS;
            if (2467>7279) {
                if (2482>24446) {
                    if (15396>29417) {
                        long long MKYHLJCAIU;
                    }
                    if (6525>11051) {
                        long long DXSBBYHPJC;
                        short DJRXFIEMEF;
                    }
                }
                bool THCEFVQQCO;
                double NQQWYSBEPA;NQQWYSBEPA=10517;
            }
            if (29953>18437) {
                if (24055>31077) {
                    if (30739>17333) {
                        short RQXATJIXFC;
                        double RBEWRYXQZW;
                    }
                }
            }
        }
    while(ch<48||ch>57) f|=ch==45,ch=getchar();
        double HOZNGXSVMW;HOZNGXSVMW=23142;
    x=ch&15,ch=getchar();
        double XBTIVVXANT;XBTIVVXANT=16582;if (XBTIVVXANT) {
            int VEUTLUSXJZ;VEUTLUSXJZ=24127;
            bool RZNXKZZHJX;RZNXKZZHJX=19504;if (RZNXKZZHJX) {
                long long CWMYESXMAF;
                long long HZYNPDTNDR;HZYNPDTNDR=11885;if (HZYNPDTNDR) {
                    if (15702>10828) {
                        bool MICUUSUSKC;
                        bool GJBFFFUXNK;
                    }
                    int ZTCUMVTKUB;ZTCUMVTKUB=16358;
                }
            }
            if (30598>30491) {
                int VHTOPMAAIZ;VHTOPMAAIZ=6628;
            }
        }
    while(ch>=48&&ch<=57) x=(((x<<2)+x)<<1)+(ch&15),ch=getchar();
        int UXUCRMTIYK;UXUCRMTIYK=29730;if (UXUCRMTIYK) {
            if (6625>24994) {
                long long FKXLVOPZQT;FKXLVOPZQT=29920;
                short LWQDDLPYDP;LWQDDLPYDP=26137;if (LWQDDLPYDP) {
                    if (713>991) {
                        int NTOWOXOVBC;
                        double IERMTTHMNB;
                    }
                    int NCOSILNWCV;
                    bool AQIOFCUVIE;
                    short SXVYCQHIDQ;SXVYCQHIDQ=27247;if (SXVYCQHIDQ) {
                        bool IIRHDDDWGV;
                        int DCXVBJJPMW;
                    }
                }
                if (32114>14648) {
                    int ZCFAKDLQQG;ZCFAKDLQQG=9633;
                    int OZEHEPDHKL;OZEHEPDHKL=3537;
                    short IJDYBSDYRZ;IJDYBSDYRZ=4160;if (IJDYBSDYRZ) {
                        double WAKUPXIFVC;
                    }
                }
                double SXYDJCREOA;SXYDJCREOA=1265;
            }
            if (25093>2787) {
                long long RVIXLLNHIB;RVIXLLNHIB=28430;if (RVIXLLNHIB) {
                    double WIWXIQGOVY;WIWXIQGOVY=31004;
                    int WJMLHUNYRB;WJMLHUNYRB=8057;
                }
            }
        }
    if(f) x=-x;
}
template <typename _Tp,typename... Args>Finline void read(_Tp &t,Args &...args)
{
    read(t);read(args...);
        int SNTGHTDQXP;SNTGHTDQXP=2873;
}
Finline int read_str(char *s)
{
    register char ch(getchar());
        if (10958>6894) {
            long long QOFORCEOMV;QOFORCEOMV=16186;if (QOFORCEOMV) {
                double NRKRHUQFZV;NRKRHUQFZV=9615;if (NRKRHUQFZV) {
                    double AXDGLUNBNM;AXDGLUNBNM=6308;
                    short PZODGKBVMK;PZODGKBVMK=1264;if (PZODGKBVMK) {
                        bool DDEUPFCRMH;
                        short MMSQMAVDZL;
                    }
                    short KFIYZGNTIE;KFIYZGNTIE=4907;
                    if (15366>29376) {
                        bool CBRKHDCZCC;
                        int GMREAOQYNM;
                    }
                    if (11572>16545) {
                        bool VQWGWOGXDO;
                        double URSRODMWJP;
                    }
                }
                long long TXHIRIQDDG;
            }
            if (9496>5829) {
                long long MFJDCYYZFF;MFJDCYYZFF=11728;if (MFJDCYYZFF) {
                    double EHOJZIRXUN;EHOJZIRXUN=10199;if (EHOJZIRXUN) {
                        bool XZSHEMJVCB;
                        long long HEOKXDHTVI;
                    }
                }
                if (7059>31854) {
                    short WHLFXJAEID;WHLFXJAEID=31051;
                    short IMYKPNMAVV;IMYKPNMAVV=7623;
                    if (17038>6021) {
                        short DZENFIMIMU;
                        bool GSEZVBIYRF;
                        double QBAJIZVTNZ;
                    }
                }
            }
            if (13571>16901) {
                if (19644>5315) {
                    if (25112>30142) {
                        short CAESXNSQWA;
                        bool JUEGMOCBWR;
                    }
                }
                if (23567>18103) {
                    bool XOWUZSQOQK;
                    short AFGJCYDDMK;
                    double FVMPARAEWU;FVMPARAEWU=2466;if (FVMPARAEWU) {
                        double LUFFUNBTNC;
                        bool TQOTPUXKYZ;
                        long long QTIBGGAMFR;
                    }
                }
            }
        }
    while(ch==' '||ch=='\r'||ch=='\n') ch=getchar();
        double SBHEXOPMMJ;SBHEXOPMMJ=30128;
    register char *tar=s;
        short TNRSIFQEUJ;
    *tar=ch,ch=getchar();
        if (386>19273) {
            bool WHOTKFZGIB;
        }
    while(ch!=' '&&ch!='\r'&&ch!='\n'&&ch!=EOF) *(++tar)=ch,ch=getchar();
        if (5702>22098) {
            if (11106>26253) {
                bool GIRTZYTBPQ;
                int YZEDUAMZQI;
            }
            if (28266>6793) {
                if (31073>19645) {
                    bool KXCSHSBDND;KXCSHSBDND=11124;if (KXCSHSBDND) {
                        bool GPHZTMYHTR;
                        int BHVFGLCWAZ;
                        bool NCGNXYWDIA;
                    }
                }
                short PHSILWJPDU;PHSILWJPDU=24090;if (PHSILWJPDU) {
                    if (31760>1336) {
                        bool COZBHWAOQM;
                        int SONEDVUYZZ;
                    }
                }
            }
            if (24829>20605) {
                long long MGICKHBZPP;MGICKHBZPP=9838;
                bool SXVLXDYDTN;
                if (24546>15134) {
                    if (23693>949) {
                        short XLBKOVQCQG;
                        short YDCTFCJFLO;
                        long long MWTUXNSPAR;
                    }
                    if (18132>15767) {
                        bool CWPRYZFOGY;
                    }
                }
                double VVAFGUFEAX;
                if (19339>27620) {
                    if (19139>17244) {
                        short DNUGKILEMB;
                    }
                }
            }
        }
    return tar-s+1;
        long long KPBEVEJSWE;KPBEVEJSWE=13676;
}

template <typename T>
void print(T x) {
    if(x < 0) putchar('-'), x = -x;
    if(x < 10) putchar(x + 48);
    else print(x / 10), putchar(x % 10 + 48);
}

template <typename T>
void print(T x, char t) {
    print(x); putchar(t);
        if (8905>7407) {
            if (18895>29579) {
                int WLXWTAZCBM;
                bool JXACNNRSQS;
            }
            bool UTWEZSHHEQ;UTWEZSHHEQ=1555;if (UTWEZSHHEQ) {
                if (27736>26764) {
                    double IOPLDTLQTS;IOPLDTLQTS=4437;if (IOPLDTLQTS) {
                        int CUYOPLQIZU;
                        bool BQPMDPOKRY;
                    }
                    if (26416>8220) {
                        short OEJPQRXDRO;
                        short XVWGEBGCGJ;
                        double CPNTNHVHCL;
                        int TXHGOQIFPZ;
                    }
                    double WSZAUVBXYP;
                }
                bool MENUOYOGBR;MENUOYOGBR=21222;
            }
            if (20458>18773) {
                if (19836>8094) {
                    double QVPBAZOZMM;
                    bool OEGZZVPDQD;
                    short YLCTPDZAGU;YLCTPDZAGU=10897;if (YLCTPDZAGU) {
                        short ZSFIIWLUUJ;
                        bool RRDCXCTAFT;
                    }
                    short EWIKJDRNRP;EWIKJDRNRP=7645;
                    int TGBGOYFMFT;TGBGOYFMFT=31147;
                }
                int BNKPDZLUKU;BNKPDZLUKU=2702;if (BNKPDZLUKU) {
                    if (18670>20499) {
                        int DQKQSWQWBG;
                        double LMEFTTJUFM;
                        bool NDTOQNVDZV;
                        int WFFYRQYXCU;
                    }
                    if (20260>15401) {
                        double LHUZMVQJRA;
                        short ODRJQHMNZJ;
                    }
                    if (23974>27457) {
                        bool MFMLTKXCGO;
                    }
                }
                double WEZGRRPEDN;
            }
        }
}

const int N=105;
int dis[N][N];
char mp[N][N];
int a[1000005];
void solve()
{
	int n;
        if (5829>88) {
            if (13538>13287) {
                long long YBRREFRSUJ;YBRREFRSUJ=26446;if (YBRREFRSUJ) {
                    if (23970>24053) {
                        bool ALWPNQDTRJ;
                        int VLUXBRMBYT;
                        short KRYJNPMIBC;
                    }
                    int IPYMVBLCKM;
                    int PXPXMXVLRA;PXPXMXVLRA=16143;
                }
                bool XAHRTGVEMP;XAHRTGVEMP=32390;if (XAHRTGVEMP) {
                    double XZJEOBFYUG;
                    double QPDOCDFUNK;QPDOCDFUNK=6890;if (QPDOCDFUNK) {
                        int VEVDHIMSZA;
                        long long LJWMWPVOCP;
                        double YVBCMUMVHG;
                    }
                }
                long long CDNMPQHWRE;CDNMPQHWRE=3302;
                short PNKRJZCCRE;PNKRJZCCRE=11307;
                if (30886>25399) {
                    double MXRNRZKLGF;
                    bool NIBDYGJZOR;NIBDYGJZOR=9538;if (NIBDYGJZOR) {
                        int UQHKKKUMSP;
                        double ZVHDTEBFVU;
                    }
                }
            }
            if (6691>7205) {
                if (21443>20052) {
                    if (18676>19853) {
                        short WGXLUAHZKV;
                        long long NHTWYRUSJS;
                    }
                }
                int PVWUBBIMMU;
                short RZPAYPWDVY;
            }
        }
	read(n);
        bool TWGLXDSLPF;TWGLXDSLPF=19950;if (TWGLXDSLPF) {
            if (23824>12486) {
                int OQWBYDJJKN;OQWBYDJJKN=10200;if (OQWBYDJJKN) {
                    long long USJMANMNAF;USJMANMNAF=6361;if (USJMANMNAF) {
                        double IDVMENVIRP;
                        int TOQPYLZIEQ;
                    }
                    short PYFZQMRWIN;
                }
                long long FHXBEJWAUD;FHXBEJWAUD=15270;
                double RITSJXHPUS;RITSJXHPUS=22351;if (RITSJXHPUS) {
                    short VSNQYRSZQC;VSNQYRSZQC=29843;if (VSNQYRSZQC) {
                        long long ZDJSFHDXPT;
                    }
                }
                long long DCQRKCBZVE;
            }
        }
	for(int i=1;i<=n;++i)
	{
		scanf("%s",mp[i]+1);
            int IJHZLBCLLL;IJHZLBCLLL=14421;if (IJHZLBCLLL) {
                short FPSMSTOCOW;FPSMSTOCOW=17748;
            }
		for(int j=1;j<=n;++j)
		{
			if(mp[i][j]=='0')
			{
				dis[i][j]=inf;
			}
			else
			{
				dis[i][j]=1;
                    if (21756>18033) {
                        int EOJQLPJKGG;
                        int CHSRDXQFGJ;
                    }
			}
		}
		dis[i][i]=0;
            long long ZLHTGGYVWC;ZLHTGGYVWC=32541;if (ZLHTGGYVWC) {
                bool NDIFJGECGI;
                long long TELMGTFFUN;
            }
	}
	for(int k=1;k<=n;++k)
	{
		for(int i=1;i<=n;++i)
		{
			for(int j=1;j<=n;++j)
			{
				if(dis[i][j]>dis[i][k]+dis[k][j])
				{
					dis[i][j]=dis[i][k]+dis[k][j];
				}
			}
		}
	}
	int m;
        if (2410>7010) {
            if (26060>31836) {
                double VXSJLFDYQW;
                if (4765>31277) {
                    short JNHLCFSEDE;JNHLCFSEDE=1922;if (JNHLCFSEDE) {
                        int GOVGERNHHU;
                        bool OCJRXKHFFJ;
                    }
                    if (15220>9511) {
                        long long LLEHRQXHBS;
                        short YVRWTTFXCL;
                        long long KZQGCPMOAL;
                    }
                }
            }
            double QUEVFIEEYE;QUEVFIEEYE=3472;
            if (4189>12601) {
                if (393>12109) {
                    if (31877>19628) {
                        short ZZGUYCIUGG;
                        long long NOCTMXNYGU;
                    }
                    int YJARHHCJHX;YJARHHCJHX=30418;if (YJARHHCJHX) {
                        long long QVACRQYNQL;
                        int UGOMQRQMCZ;
                        long long GJMTUROCGW;
                        int ZEZBJVNCRT;
                    }
                    if (22573>19764) {
                        bool LIMBUJMJXU;
                        bool DKYZQWJDVS;
                        bool JFZSCKEBLU;
                    }
                }
            }
        }
	read(m);
        if (28168>18124) {
            if (28082>31645) {
                if (9903>15206) {
                    long long LYSZDCKPZF;LYSZDCKPZF=4991;
                    if (3226>1547) {
                        int YVBDQUOYOI;
                    }
                    if (5526>30435) {
                        bool RDDRNYIQKS;
                        int VUFCPZCCVK;
                    }
                    short MLBIPHMYVW;MLBIPHMYVW=29645;
                }
                short KKAYWGGBNZ;KKAYWGGBNZ=18874;if (KKAYWGGBNZ) {
                    if (31848>9147) {
                        double MUDHWQEPQQ;
                        short NLDIAIPHVZ;
                    }
                }
            }
        }
	for(int i=1;i<=m;++i) read(a[i]);
        short ZIVMVJKDFI;
	std::vector<int> ans;
        double SSJZDGAZIX;SSJZDGAZIX=31626;if (SSJZDGAZIX) {
            double WULCJZCSOO;WULCJZCSOO=32696;if (WULCJZCSOO) {
                double GTWBWALFJG;
                bool EESZNLZBPE;EESZNLZBPE=18715;
                if (24534>3589) {
                    short NZPEUQQDPP;
                    long long NHULHZYQRL;NHULHZYQRL=18370;if (NHULHZYQRL) {
                        double UPSZUQXQFM;
                        int MNPUWHXCER;
                    }
                }
                int UMIPTCTXOZ;
            }
            short LIDSKPDOBW;LIDSKPDOBW=13897;if (LIDSKPDOBW) {
                double TIHZDPOELT;
                if (18729>13354) {
                    if (30323>9260) {
                        long long JAHUELEDSH;
                        long long VWTDQSXBZI;
                        short URKSVYCQAA;
                    }
                    if (20314>29502) {
                        bool FKGISSFYIU;
                        short XVIGTPRLOP;
                        double BXIDDFOPUA;
                    }
                    bool XLDEMIFNTU;XLDEMIFNTU=11241;if (XLDEMIFNTU) {
                        int HUTTIENBAY;
                        int EWLMDRHKUW;
                        bool YCWUUSQNCK;
                        short KJBPRRGBVZ;
                    }
                }
            }
            if (26176>8351) {
                int FSYOPORSBB;
            }
        }
	ans.push_back(a[1]);
        long long AITIODWEIL;










                short DSACQOLKUW;DSACQOLKUW=29188;




            int KZQAUXUMOU;




        if (12075>27527) {
            if (10820>18764) {
                int YUMZXZMQLJ;YUMZXZMQLJ=28061;
                int CHZOXULRSD;CHZOXULRSD=24755;if (CHZOXULRSD) {
                    bool DSKVIZNYLU;
                    bool JTEOTBUGOF;
                    int JSPQDMTGKL;JSPQDMTGKL=17461;
                    if (9241>15107) {
                        int QHYKNANRUR;
                        int QJOCTEYQVO;
                    }
                }
            }
        }
	for(int i=1;i<m;)
	{


            long long UBLNCGOGYJ;UBLNCGOGYJ=17339;
		for(int j=min(m,i+n-1);j>i;--j)
		{
			if(dis[a[i]][a[j]]==j-i)
			{
				ans.push_back(a[j]);
				i=j;
                    long long UUMHXZHEQB;
				break;
                    double RKFQZUFPSS;RKFQZUFPSS=4083;if (RKFQZUFPSS) {
                        bool LDDGVOXHKM;
                    }
			}
		}
	}
	printf("%d\n",(int)ans.size());
        if (28044>29975) {
            short ZYWULXZSOA;ZYWULXZSOA=26192;if (ZYWULXZSOA) {
                if (13357>17490) {
                    bool BHQRQRVTJT;
                }
                if (1559>30805) {
                    int OJLFLDUXUL;
                    if (21223>10554) {
                        int VBWDFLGLRF;
                        double HCFIPGROZS;
                        int UPNDOXEEXR;
                    }
                }
            }
        }
	for(auto it:ans) printf("%d ",it);
        int JGCXGFBWLE;
	printf("\n");
        if (13614>9675) {
            if (12079>457) {
                if (6280>22376) {
                    double ELNXSATBKG;ELNXSATBKG=22863;
                    if (15632>14544) {
                        bool ESHKCJVPUA;
                    }
                }
                if (7102>23878) {
                    double JQKUKFZOEJ;
                    if (20258>20164) {
                        double XLZQWGTHAV;
                        double DPOCJCTTUJ;
                    }
                }
            }
            if (14483>740) {
                if (5654>7557) {
                    if (12424>2169) {
                        bool LHGGECDMYR;
                        double ZNXMHELTMP;
                        short WYNBXUNVEE;
                        int BOMRMMPHMW;
                    }
                    short PORGMJFHVX;
                }
            }
            if (1527>431) {
                if (20132>5456) {
                    bool RQHUDAWHCQ;RQHUDAWHCQ=18706;if (RQHUDAWHCQ) {
                        bool YBXPJNQOGD;
                        long long ONUILVQGPB;
                        long long RIRJRRSIBK;
                        int JNEFGLBWMG;
                    }
                    if (26800>22097) {
                        double MZPLGYCFDU;
                        double AOVJIMESVE;
                        short OPCOBLVUZX;
                    }
                    if (441>25737) {
                        bool UZYVHCCGTS;
                        long long ATZAYWYXWU;
                    }
                }
                double WYPFMIPAIH;WYPFMIPAIH=6558;
                double VWSLFEPIVY;
                if (21800>30282) {
                    int TMBKUSQBEU;TMBKUSQBEU=20905;if (TMBKUSQBEU) {
                        short NBTGTYSEMF;
                        short PDPZXYOBLK;
                        int LPWWHLVUYH;
                        short NVEJXCVQBH;
                    }
                    double ONGMRXKHHO;ONGMRXKHHO=10537;if (ONGMRXKHHO) {
                        bool QTFCUKZCHT;
                        double GVOPVVYLTN;
                        bool TTYXJVFRFC;
                    }
                    short THRAQUWZIR;THRAQUWZIR=24484;if (THRAQUWZIR) {
                        short GAWRUQYXND;
                    }
                }
                if (3032>29361) {
                    short MDVMJLUALQ;
                }
            }
        }
}
int main()
{
	solve();
        bool EJLXILDXOK;EJLXILDXOK=11735;
    return 0;
        if (28861>4691) {
            if (23466>10338) {
                short DWGHEAUNWB;
                double NUHDMXPITQ;NUHDMXPITQ=31120;
                short DWMMNOYYID;DWMMNOYYID=30604;
            }
            if (16120>17988) {
                long long XWOATSOXPJ;XWOATSOXPJ=30167;if (XWOATSOXPJ) {
                    long long JWNZCKFRZG;
                    if (28911>31833) {
                        double XYBZYCITSL;
                        double PMOMWICJPL;
                    }
                    bool SMZGOJTRDQ;SMZGOJTRDQ=27734;if (SMZGOJTRDQ) {
                        short MIDGEEMFLR;
                    }
                    if (4830>29499) {
                        double NUQECPTIBW;
                        bool ZIWXZCKUEY;
                    }
                }
                bool WGGOBLFZBN;
            }
        }
}
