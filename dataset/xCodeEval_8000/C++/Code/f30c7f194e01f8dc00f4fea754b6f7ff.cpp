#include<iostream>
#include<cstdlib>
#include<cstring>
#include<algorithm>
#include<cmath>
#include<stdio.h>
#include<vector>
#include<map>
#define o2AKRXfU )
#define SN5e8jTMdl9 }
#define kjuisdfnmn int
#define KXcbdsuioWEisodufb asduyrefgdf
#define djksfuoiu cout
#define saduoiopnsdfsd djksfuoiu
#define waZ5UsI2a5w ]
#define ECLBXHaE1wcnJTQ8lwhlM [
#define ldl8kZFzzYbJI1v5X TvywQ9X6LEQ
#define XI9Zjdj4IndSo9kfeh ECLBXHaE1wcnJTQ8lwhlM
#define sdjkhfjdshf324 for
#define zQ8kn177iMP6 XI9Zjdj4IndSo9kfeh
#define jWEH5wdkwIL2DbhCh9DRnXv nRYlYOCcMbQ
#define iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh eriukjjkkdjfgjhgyuyudsif
#define aEG4xFeHp5LT Gw0M7M
#define xcRQbFu HW5nBn
#define MjQWhJU2WyDQtLasvquD+eSP o2AKRXfU
#define e1EKk4nLeC4zzXb7 o2AKRXfU
#define jmsdfkWQEr22FSD234SDFFwasd ASDFasd1dfdsfsdf
#define ZPokVjqwsadLasdhjysad sdufuioiovxcmvnusd
#define ASDFasd1dfdsfsdf dsjhfucheSDFsdfsdf
#define sdfoiuin uiooqwuyyfjsdh
#define dsjfhjkiu jhdsfuyhuhbbnsdDesdF
#define asdhjsajdhubasd if
#define jhdsfuiiiuoiasdids dsjfhjkiu
#define KlopQXZvnuiuasdbbnbdsaioqw jhdsfuiiiuoiasdids
#define TvywQ9X6LEQ SN5e8jTMdl9
#define uiooqwuyyfjsdh asduiyhooXCVASwj
#define jhdsfuyhuhbbnsdDesdF ==
#define UIMNyJOKoeKNUbo {
#define D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc ldl8kZFzzYbJI1v5X
#define JDDUobOmXqpDbWPXcxt4oo44Inle c1ao3qn8KLtbB
#define uyuiuoqwMSDFiuyfdsFDS sdfoiuin
#define UHJHJdgsyduiyuiyu234r sdjkhfjdshf324
#define c1ao3qn8KLtbB Gw0M7M
#define eriukjjkkdjfgjhgyuyudsif UHJHJdgsyduiyuiyu234r
#define asduiyhooXCVASwj main
#define dsjhfucheSDFsdfsdf asdhjsajdhubasd
#define sdufuioiovxcmvnusd saduoiopnsdfsd
#define jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI e1EKk4nLeC4zzXb7
#define Gw0M7M (
#define jkpoasduihnfdsfnm kjuisdfnmn
#define asduyrefgdf jkpoasduihnfdsfnm
#define nRYlYOCcMbQ MbQxACtS3KCt
#define MbQxACtS3KCt UIMNyJOKoeKNUbo
#define HW5nBn waZ5UsI2a5w
using namespace std;
const int mod=1e9+9,base=27;
struct pp
 jWEH5wdkwIL2DbhCh9DRnXv 
	int id;
	char ch;
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc ;
pp now;
vector<pp>adj zQ8kn177iMP6 20201 xcRQbFu ,tadj zQ8kn177iMP6 20201 xcRQbFu  zQ8kn177iMP6 26 xcRQbFu ;
int tr zQ8kn177iMP6 2 xcRQbFu  zQ8kn177iMP6 20100 xcRQbFu ,ex zQ8kn177iMP6 20100 xcRQbFu ;
int ps zQ8kn177iMP6 20100 xcRQbFu ,pom zQ8kn177iMP6 20100 xcRQbFu ,di zQ8kn177iMP6 20100 xcRQbFu ,ha zQ8kn177iMP6 2 xcRQbFu  zQ8kn177iMP6 20100 xcRQbFu ,pd zQ8kn177iMP6 20100 xcRQbFu ,ls zQ8kn177iMP6 55 xcRQbFu ,cnt_ls,deep zQ8kn177iMP6 20010 xcRQbFu ,pw zQ8kn177iMP6 20100 xcRQbFu ,lm zQ8kn177iMP6 20100 xcRQbFu ,cnt_lm;
int n,num_q,ans zQ8kn177iMP6 20100 xcRQbFu ,num_node,size zQ8kn177iMP6 20100 xcRQbFu ,mi,ch,pa zQ8kn177iMP6 20100 xcRQbFu ,to zQ8kn177iMP6 20100 xcRQbFu ,cr zQ8kn177iMP6 401000 xcRQbFu ;
bool vis zQ8kn177iMP6 20100 xcRQbFu ;
int bs zQ8kn177iMP6 400100 xcRQbFu ,trie zQ8kn177iMP6 401000 xcRQbFu  zQ8kn177iMP6 26 xcRQbFu ,queue zQ8kn177iMP6 20110 xcRQbFu ,temp1,temp2,temp,dist zQ8kn177iMP6 400000 xcRQbFu ,tw zQ8kn177iMP6 401000 xcRQbFu ,list zQ8kn177iMP6 401000 xcRQbFu ,cnt_list,pos zQ8kn177iMP6 401000 xcRQbFu ,hs zQ8kn177iMP6 2 xcRQbFu  zQ8kn177iMP6 400000 xcRQbFu ,pc zQ8kn177iMP6 401000 xcRQbFu ,sum zQ8kn177iMP6 401000 xcRQbFu ;
int pk zQ8kn177iMP6 401000 xcRQbFu ,pe zQ8kn177iMP6 401000 xcRQbFu ,sz zQ8kn177iMP6 401000 xcRQbFu  zQ8kn177iMP6 27 xcRQbFu ,zz zQ8kn177iMP6 20100 xcRQbFu ;
int pm zQ8kn177iMP6 20100 xcRQbFu ;
struct qr
 jWEH5wdkwIL2DbhCh9DRnXv 
	int y,id;
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc ;
vector<qr>vr zQ8kn177iMP6 20010 xcRQbFu ;
qr nw;
vector<int>vec zQ8kn177iMP6 20100 xcRQbFu ;
void prp JDDUobOmXqpDbWPXcxt4oo44Inle int id,int pr jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int i,j,s,p,q,ip,ch=-1;
	pa zQ8kn177iMP6 id xcRQbFu =pr;
	di zQ8kn177iMP6 id xcRQbFu =0;
	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<adj zQ8kn177iMP6 id xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		ip=adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu .id;
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ip KlopQXZvnuiuasdbbnbdsaioqw pr jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		    continue;
        deep zQ8kn177iMP6 ip xcRQbFu =deep zQ8kn177iMP6 id xcRQbFu +1;
        prp JDDUobOmXqpDbWPXcxt4oo44Inle ip,id jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
         jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle di zQ8kn177iMP6 id xcRQbFu <di zQ8kn177iMP6 ip xcRQbFu +1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
         jWEH5wdkwIL2DbhCh9DRnXv 
        	di zQ8kn177iMP6 id xcRQbFu =di zQ8kn177iMP6 ip xcRQbFu +1;
        	ch=i;
         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ch>=0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		swap JDDUobOmXqpDbWPXcxt4oo44Inle adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 ch xcRQbFu ,adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 0 xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
		ps zQ8kn177iMP6 adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 0 xcRQbFu .id xcRQbFu =id;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
void gps JDDUobOmXqpDbWPXcxt4oo44Inle int id jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int i,j,s,p,q,ip;
	lm zQ8kn177iMP6 cnt_lm++ xcRQbFu =id;
	pom zQ8kn177iMP6 id xcRQbFu =cnt_lm-1;
	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<adj zQ8kn177iMP6 id xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		ip=adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu .id;
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ip KlopQXZvnuiuasdbbnbdsaioqw pa zQ8kn177iMP6 id xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		   continue;
        pd zQ8kn177iMP6 ip xcRQbFu =adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu .ch-'a';
        gps JDDUobOmXqpDbWPXcxt4oo44Inle ip jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
void ho JDDUobOmXqpDbWPXcxt4oo44Inle int id jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int i,j,s,p,q,ch=-1;
	dist zQ8kn177iMP6 id xcRQbFu =0;
	sz zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 0 xcRQbFu =bs zQ8kn177iMP6 id xcRQbFu ;
	tw zQ8kn177iMP6 id xcRQbFu =id;
	cr zQ8kn177iMP6 id xcRQbFu =-1;
	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<26;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle trie zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu >0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		 jWEH5wdkwIL2DbhCh9DRnXv 
		   ho JDDUobOmXqpDbWPXcxt4oo44Inle trie zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
		   pc zQ8kn177iMP6 trie zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu  xcRQbFu =i;
		   sz zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i+1 xcRQbFu =sz zQ8kn177iMP6 trie zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu  xcRQbFu  zQ8kn177iMP6 26 xcRQbFu ;
		    jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle dist zQ8kn177iMP6 id xcRQbFu <dist zQ8kn177iMP6 trie zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu  xcRQbFu +1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
  	   	    jWEH5wdkwIL2DbhCh9DRnXv 
   		 	   dist zQ8kn177iMP6 id xcRQbFu =dist zQ8kn177iMP6 trie zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu  xcRQbFu +1;
   		       cr zQ8kn177iMP6 id xcRQbFu =ch=trie zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu ;   
  	   	    D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
		 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ch>=0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
	   tw zQ8kn177iMP6 id xcRQbFu =tw zQ8kn177iMP6 ch xcRQbFu ;
	   pk zQ8kn177iMP6 ch xcRQbFu =id;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<26;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
       sz zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i+1 xcRQbFu +=sz zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu ;
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
void tra JDDUobOmXqpDbWPXcxt4oo44Inle int id jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int i,j,s,p,q;
	list zQ8kn177iMP6 cnt_list++ xcRQbFu =id;
	pos zQ8kn177iMP6 id xcRQbFu =cnt_list-1;
	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle cr zQ8kn177iMP6 id xcRQbFu >=0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	   tra JDDUobOmXqpDbWPXcxt4oo44Inle cr zQ8kn177iMP6 id xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
     iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<26;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
     jWEH5wdkwIL2DbhCh9DRnXv 
    	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle trie zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu >0&&trie zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu !=cr zQ8kn177iMP6 id xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
    	   tra JDDUobOmXqpDbWPXcxt4oo44Inle trie zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
void get_size JDDUobOmXqpDbWPXcxt4oo44Inle int id,int pr jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int i,j,s,p,q,ip;
	size zQ8kn177iMP6 id xcRQbFu =vr zQ8kn177iMP6 id xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI +1;
	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<adj zQ8kn177iMP6 id xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		ip=adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu .id;
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle !vis zQ8kn177iMP6 ip xcRQbFu &&ip!=pr jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		 jWEH5wdkwIL2DbhCh9DRnXv 
			get_size JDDUobOmXqpDbWPXcxt4oo44Inle ip,id jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
			size zQ8kn177iMP6 id xcRQbFu +=size zQ8kn177iMP6 ip xcRQbFu ;
		 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
void choose_root JDDUobOmXqpDbWPXcxt4oo44Inle int id,int pr,int now_sz,int &ch jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int i,j,s,p,q,ax=now_sz,ip;
	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<adj zQ8kn177iMP6 id xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		ip=adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu .id;
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ip KlopQXZvnuiuasdbbnbdsaioqw pr||vis zQ8kn177iMP6 ip xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		    continue;
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ax<size zQ8kn177iMP6 ip xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
			ax=size zQ8kn177iMP6 ip xcRQbFu ;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle mi>ax jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		mi=ax;
		ch=id; 
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<adj zQ8kn177iMP6 id xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		ip=adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu .id;
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ip KlopQXZvnuiuasdbbnbdsaioqw pr||vis zQ8kn177iMP6 ip xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		    continue;
		choose_root JDDUobOmXqpDbWPXcxt4oo44Inle ip,id,now_sz+size zQ8kn177iMP6 id xcRQbFu -size zQ8kn177iMP6 ip xcRQbFu ,ch jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;	
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
void construct JDDUobOmXqpDbWPXcxt4oo44Inle int id,bool flag jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int i,j,s,p,q,ch,ip,ro,idd;
	to zQ8kn177iMP6 id xcRQbFu =num_node;
	queue zQ8kn177iMP6 0 xcRQbFu =id;
	bs zQ8kn177iMP6 num_node xcRQbFu =1;
	pe zQ8kn177iMP6 num_node xcRQbFu =-1;
	memset JDDUobOmXqpDbWPXcxt4oo44Inle trie zQ8kn177iMP6 num_node xcRQbFu ,0,sizeof JDDUobOmXqpDbWPXcxt4oo44Inle trie zQ8kn177iMP6 num_node xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
	num_node++;
	temp1=temp2=0;
	temp=1;
	vis zQ8kn177iMP6 id xcRQbFu =true;
	while JDDUobOmXqpDbWPXcxt4oo44Inle temp1<=temp2 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=temp1;i<=temp2;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		 jWEH5wdkwIL2DbhCh9DRnXv 
			idd=queue zQ8kn177iMP6 i xcRQbFu ;
			 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle j=0;j<adj zQ8kn177iMP6 idd xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;j++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
			 jWEH5wdkwIL2DbhCh9DRnXv 
				ch=adj zQ8kn177iMP6 idd xcRQbFu  zQ8kn177iMP6 j xcRQbFu .ch-'a';
				ip=adj zQ8kn177iMP6 idd xcRQbFu  zQ8kn177iMP6 j xcRQbFu .id;
				 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle !vis zQ8kn177iMP6 ip xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
				 jWEH5wdkwIL2DbhCh9DRnXv 
					 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle flag KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
					 jWEH5wdkwIL2DbhCh9DRnXv 
				        jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle idd KlopQXZvnuiuasdbbnbdsaioqw id jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
				    		pm zQ8kn177iMP6 ip xcRQbFu =ip;
				    	else
				    	    pm zQ8kn177iMP6 ip xcRQbFu =pm zQ8kn177iMP6 idd xcRQbFu ;
					 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
					 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle trie zQ8kn177iMP6 to zQ8kn177iMP6 idd xcRQbFu  xcRQbFu  zQ8kn177iMP6 ch xcRQbFu  KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
					 jWEH5wdkwIL2DbhCh9DRnXv 
						bs zQ8kn177iMP6 num_node xcRQbFu =0;
						pe zQ8kn177iMP6 num_node xcRQbFu =to zQ8kn177iMP6 idd xcRQbFu ;
						memset JDDUobOmXqpDbWPXcxt4oo44Inle trie zQ8kn177iMP6 num_node xcRQbFu ,0,sizeof JDDUobOmXqpDbWPXcxt4oo44Inle trie zQ8kn177iMP6 num_node xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
						trie zQ8kn177iMP6 to zQ8kn177iMP6 idd xcRQbFu  xcRQbFu  zQ8kn177iMP6 ch xcRQbFu =num_node++;  
					 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
					to zQ8kn177iMP6 ip xcRQbFu =trie zQ8kn177iMP6 to zQ8kn177iMP6 idd xcRQbFu  xcRQbFu  zQ8kn177iMP6 ch xcRQbFu ;
					bs zQ8kn177iMP6 to zQ8kn177iMP6 ip xcRQbFu  xcRQbFu ++;
					vis zQ8kn177iMP6 ip xcRQbFu =true;
					queue zQ8kn177iMP6 temp++ xcRQbFu =ip;
					 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle flag KlopQXZvnuiuasdbbnbdsaioqw 0&&vr zQ8kn177iMP6 ip xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI >0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
					    vec zQ8kn177iMP6 pm zQ8kn177iMP6 ip xcRQbFu  xcRQbFu .push_back JDDUobOmXqpDbWPXcxt4oo44Inle ip jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
				 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
			 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
		 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
		temp1=temp2+1;
		temp2=temp-1;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<temp;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	   vis zQ8kn177iMP6 queue zQ8kn177iMP6 i xcRQbFu  xcRQbFu =false;
     iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=to zQ8kn177iMP6 id xcRQbFu ;i<num_node;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
     jWEH5wdkwIL2DbhCh9DRnXv 
    	pk zQ8kn177iMP6 i xcRQbFu =i;
       memset JDDUobOmXqpDbWPXcxt4oo44Inle sz zQ8kn177iMP6 i xcRQbFu ,0,sizeof JDDUobOmXqpDbWPXcxt4oo44Inle sz zQ8kn177iMP6 i xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
    pc zQ8kn177iMP6 to zQ8kn177iMP6 id xcRQbFu  xcRQbFu =-1;
    ho JDDUobOmXqpDbWPXcxt4oo44Inle to zQ8kn177iMP6 id xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    tra JDDUobOmXqpDbWPXcxt4oo44Inle to zQ8kn177iMP6 id xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
     iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=to zQ8kn177iMP6 id xcRQbFu ;i<num_node;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
       pk zQ8kn177iMP6 list zQ8kn177iMP6 i xcRQbFu  xcRQbFu =pk zQ8kn177iMP6 pk zQ8kn177iMP6 list zQ8kn177iMP6 i xcRQbFu  xcRQbFu  xcRQbFu ; 
	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle pos zQ8kn177iMP6 to zQ8kn177iMP6 id xcRQbFu  xcRQbFu  KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
    	hs zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 pos zQ8kn177iMP6 to zQ8kn177iMP6 id xcRQbFu  xcRQbFu  xcRQbFu =pw zQ8kn177iMP6 id xcRQbFu +1;
    else
     jWEH5wdkwIL2DbhCh9DRnXv 
        hs zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 pos zQ8kn177iMP6 to zQ8kn177iMP6 id xcRQbFu  xcRQbFu  xcRQbFu = JDDUobOmXqpDbWPXcxt4oo44Inle int jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  JDDUobOmXqpDbWPXcxt4oo44Inle  JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI hs zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 pos zQ8kn177iMP6 to zQ8kn177iMP6 id xcRQbFu  xcRQbFu -1 xcRQbFu * JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI base%mod jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
        hs zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 pos zQ8kn177iMP6 to zQ8kn177iMP6 id xcRQbFu  xcRQbFu  xcRQbFu = JDDUobOmXqpDbWPXcxt4oo44Inle hs zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 pos zQ8kn177iMP6 to zQ8kn177iMP6 id xcRQbFu  xcRQbFu  xcRQbFu +pw zQ8kn177iMP6 id xcRQbFu +1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI %mod;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
    sum zQ8kn177iMP6 pos zQ8kn177iMP6 to zQ8kn177iMP6 id xcRQbFu  xcRQbFu  xcRQbFu =0;
  	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=pos zQ8kn177iMP6 to zQ8kn177iMP6 id xcRQbFu  xcRQbFu ;i<cnt_list-1;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
     jWEH5wdkwIL2DbhCh9DRnXv 
       	hs zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 i+1 xcRQbFu = JDDUobOmXqpDbWPXcxt4oo44Inle int jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  JDDUobOmXqpDbWPXcxt4oo44Inle  JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI hs zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 i xcRQbFu * JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI base%mod jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
       	hs zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 i+1 xcRQbFu = JDDUobOmXqpDbWPXcxt4oo44Inle hs zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 i+1 xcRQbFu +pc zQ8kn177iMP6 list zQ8kn177iMP6 i+1 xcRQbFu  xcRQbFu +1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI %mod;
       	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle i+1<cnt_list jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
           	sum zQ8kn177iMP6 i+1 xcRQbFu =sum zQ8kn177iMP6 i xcRQbFu +sz zQ8kn177iMP6 list zQ8kn177iMP6 i xcRQbFu  xcRQbFu  zQ8kn177iMP6 pc zQ8kn177iMP6 list zQ8kn177iMP6 i+1 xcRQbFu  xcRQbFu  xcRQbFu ;
        else
             sum zQ8kn177iMP6 i+1 xcRQbFu =sum zQ8kn177iMP6 i xcRQbFu +1;
     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
     iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=cnt_list-1;i>=pos zQ8kn177iMP6 to zQ8kn177iMP6 id xcRQbFu  xcRQbFu ;i-- jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
     jWEH5wdkwIL2DbhCh9DRnXv 
    	hs zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 i xcRQbFu = JDDUobOmXqpDbWPXcxt4oo44Inle int jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  JDDUobOmXqpDbWPXcxt4oo44Inle  JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI hs zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 i+1 xcRQbFu * JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI base%mod jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle i>pos zQ8kn177iMP6 to zQ8kn177iMP6 id xcRQbFu  xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		   hs zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 i xcRQbFu = JDDUobOmXqpDbWPXcxt4oo44Inle hs zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 i xcRQbFu +pc zQ8kn177iMP6 list zQ8kn177iMP6 i xcRQbFu  xcRQbFu +1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI %mod;
	   else
	       hs zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 i xcRQbFu = JDDUobOmXqpDbWPXcxt4oo44Inle hs zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 i xcRQbFu +pw zQ8kn177iMP6 id xcRQbFu +1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI %mod;
     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
int lca JDDUobOmXqpDbWPXcxt4oo44Inle int x,int y jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	while JDDUobOmXqpDbWPXcxt4oo44Inle true jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ps zQ8kn177iMP6 x xcRQbFu  KlopQXZvnuiuasdbbnbdsaioqw ps zQ8kn177iMP6 y xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		 jWEH5wdkwIL2DbhCh9DRnXv 
			 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle pom zQ8kn177iMP6 x xcRQbFu <pom zQ8kn177iMP6 y xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
			   return x;
            return y;
		 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle deep zQ8kn177iMP6 ps zQ8kn177iMP6 x xcRQbFu  xcRQbFu >deep zQ8kn177iMP6 ps zQ8kn177iMP6 y xcRQbFu  xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
			x=pa zQ8kn177iMP6 ps zQ8kn177iMP6 x xcRQbFu  xcRQbFu ;
		else
		    y=pa zQ8kn177iMP6 ps zQ8kn177iMP6 y xcRQbFu  xcRQbFu ;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
int query JDDUobOmXqpDbWPXcxt4oo44Inle int flag,int left,int right jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int ret;
	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle flag KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		ret=ha zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 right xcRQbFu - JDDUobOmXqpDbWPXcxt4oo44Inle int jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  JDDUobOmXqpDbWPXcxt4oo44Inle  JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ha zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 left-1 xcRQbFu * JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ex zQ8kn177iMP6 right-left+1 xcRQbFu %mod jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
	else  jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle flag KlopQXZvnuiuasdbbnbdsaioqw 1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	    ret=hs zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 right xcRQbFu - JDDUobOmXqpDbWPXcxt4oo44Inle int jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  JDDUobOmXqpDbWPXcxt4oo44Inle  JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI hs zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 left-1 xcRQbFu * JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ex zQ8kn177iMP6 right-left+1 xcRQbFu %mod jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    else  jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle flag KlopQXZvnuiuasdbbnbdsaioqw 2 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
        ret=hs zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 left xcRQbFu - JDDUobOmXqpDbWPXcxt4oo44Inle int jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  JDDUobOmXqpDbWPXcxt4oo44Inle  JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI hs zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 right+1 xcRQbFu * JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ex zQ8kn177iMP6 right-left+1 xcRQbFu %mod jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    else
        ret= JDDUobOmXqpDbWPXcxt4oo44Inle ha zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 left xcRQbFu - JDDUobOmXqpDbWPXcxt4oo44Inle int jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  JDDUobOmXqpDbWPXcxt4oo44Inle  JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ha zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 right+1 xcRQbFu * JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ex zQ8kn177iMP6 right-left+1 xcRQbFu %mod jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ret<0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  
        ret+=mod;
    return ret;
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
int solve JDDUobOmXqpDbWPXcxt4oo44Inle int x1,int lca,int x,int y,bool ju,int u jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int i,j,s,p,q,low,high,mid,ret=0,ch,flag;
	while JDDUobOmXqpDbWPXcxt4oo44Inle !ju||x!=pom zQ8kn177iMP6 y xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle !ju&&x KlopQXZvnuiuasdbbnbdsaioqw lca jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		 jWEH5wdkwIL2DbhCh9DRnXv 
		   ju=true;
		   x=pom zQ8kn177iMP6 x xcRQbFu ;
		 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ju&&x KlopQXZvnuiuasdbbnbdsaioqw pom zQ8kn177iMP6 y xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		    break;
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ju&&x KlopQXZvnuiuasdbbnbdsaioqw pom zQ8kn177iMP6 ls zQ8kn177iMP6 u-1 xcRQbFu  xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
         jWEH5wdkwIL2DbhCh9DRnXv 
        	u--;
            x=pom zQ8kn177iMP6 ps zQ8kn177iMP6 ls zQ8kn177iMP6 u-1 xcRQbFu  xcRQbFu  xcRQbFu -1;
         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
         jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ju KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
         jWEH5wdkwIL2DbhCh9DRnXv 
        	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ps zQ8kn177iMP6 x xcRQbFu !=ps zQ8kn177iMP6 lca xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
        	   high=pom zQ8kn177iMP6 x xcRQbFu -pom zQ8kn177iMP6 ps zQ8kn177iMP6 x xcRQbFu  xcRQbFu +1;
			 else
     	       high=pom zQ8kn177iMP6 x xcRQbFu -pom zQ8kn177iMP6 lca xcRQbFu ;
             ch=pd zQ8kn177iMP6 x xcRQbFu ;
         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
        else
         jWEH5wdkwIL2DbhCh9DRnXv 
    	    ch=pd zQ8kn177iMP6 lm zQ8kn177iMP6 x+1 xcRQbFu  xcRQbFu ;
        	high=pom zQ8kn177iMP6 ls zQ8kn177iMP6 u-1 xcRQbFu  xcRQbFu -x;
         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
		high=min JDDUobOmXqpDbWPXcxt4oo44Inle high,pos zQ8kn177iMP6 tw zQ8kn177iMP6 x1 xcRQbFu  xcRQbFu -pos zQ8kn177iMP6 x1 xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
       	int ll,rr;
		low=0;
		while JDDUobOmXqpDbWPXcxt4oo44Inle low<=high jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
         jWEH5wdkwIL2DbhCh9DRnXv 
        	mid= JDDUobOmXqpDbWPXcxt4oo44Inle low+high jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI >>1;
			 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ju KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
        	 jWEH5wdkwIL2DbhCh9DRnXv 
	        	ll=pom zQ8kn177iMP6 x xcRQbFu -mid+1;
	        	rr=pom zQ8kn177iMP6 x xcRQbFu ;
	        	flag=3;
	         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	        else
	         jWEH5wdkwIL2DbhCh9DRnXv 
        		ll=x+1;
        		rr=x+mid;
        		flag=0;
        	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
        	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle query JDDUobOmXqpDbWPXcxt4oo44Inle 1,pos zQ8kn177iMP6 x1 xcRQbFu +1,pos zQ8kn177iMP6 x1 xcRQbFu +mid jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  KlopQXZvnuiuasdbbnbdsaioqw query JDDUobOmXqpDbWPXcxt4oo44Inle flag,ll,rr jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
        	    low=mid+1;
    	    else
    	        high=mid-1;
         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
         jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle high KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
         jWEH5wdkwIL2DbhCh9DRnXv 
        	ret+=sz zQ8kn177iMP6 x1 xcRQbFu  zQ8kn177iMP6 ch xcRQbFu ;
        	high=1;
        	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle trie zQ8kn177iMP6 x1 xcRQbFu  zQ8kn177iMP6 ch xcRQbFu  KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
        	    break;
			x1=trie zQ8kn177iMP6 x1 xcRQbFu  zQ8kn177iMP6 ch xcRQbFu ;
         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
        else
         jWEH5wdkwIL2DbhCh9DRnXv 
            ret+=sum zQ8kn177iMP6 pos zQ8kn177iMP6 x1 xcRQbFu +high xcRQbFu -sum zQ8kn177iMP6 pos zQ8kn177iMP6 x1 xcRQbFu  xcRQbFu ;
            x1=list zQ8kn177iMP6 pos zQ8kn177iMP6 x1 xcRQbFu +high xcRQbFu ;
		 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ju KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
			x=pa zQ8kn177iMP6 lm zQ8kn177iMP6 pom zQ8kn177iMP6 x xcRQbFu -high+1 xcRQbFu  xcRQbFu ;
		else
          	x=x+high;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	return ret;
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
int get_path JDDUobOmXqpDbWPXcxt4oo44Inle int from,int to,int &x,int y,int lca,bool &ju,int &u jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int dx,ch,flag;
	while JDDUobOmXqpDbWPXcxt4oo44Inle from!=pe zQ8kn177iMP6 to xcRQbFu && JDDUobOmXqpDbWPXcxt4oo44Inle !ju||x!=pom zQ8kn177iMP6 y xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle !ju&&x KlopQXZvnuiuasdbbnbdsaioqw lca jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		 jWEH5wdkwIL2DbhCh9DRnXv 
			ju=true;
			x=pom zQ8kn177iMP6 x xcRQbFu ;
		 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ju&&x KlopQXZvnuiuasdbbnbdsaioqw pom zQ8kn177iMP6 y xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		    break;
         jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ju&&x KlopQXZvnuiuasdbbnbdsaioqw pom zQ8kn177iMP6 ls zQ8kn177iMP6 u-1 xcRQbFu  xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
         jWEH5wdkwIL2DbhCh9DRnXv 
        	u--;
        	x=pom zQ8kn177iMP6 ps zQ8kn177iMP6 ls zQ8kn177iMP6 u-1 xcRQbFu  xcRQbFu  xcRQbFu -1;
         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
         jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ju KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
         jWEH5wdkwIL2DbhCh9DRnXv 
        	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ps zQ8kn177iMP6 x xcRQbFu !=ps zQ8kn177iMP6 lca xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
        	   dx=pom zQ8kn177iMP6 x xcRQbFu -pom zQ8kn177iMP6 ps zQ8kn177iMP6 x xcRQbFu  xcRQbFu +1;
     	    else
     	       dx=pom zQ8kn177iMP6 x xcRQbFu -pom zQ8kn177iMP6 lca xcRQbFu ;
  	        flag=3;
			ch=pd zQ8kn177iMP6 x xcRQbFu ;
         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
        else
         jWEH5wdkwIL2DbhCh9DRnXv 
        	ch=pd zQ8kn177iMP6 lm zQ8kn177iMP6 x+1 xcRQbFu  xcRQbFu ;
        	dx=pom zQ8kn177iMP6 ls zQ8kn177iMP6 u-1 xcRQbFu  xcRQbFu -x;
        	flag=0;
         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc  
         jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle pk zQ8kn177iMP6 from xcRQbFu  KlopQXZvnuiuasdbbnbdsaioqw pk zQ8kn177iMP6 to xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
        	dx=min JDDUobOmXqpDbWPXcxt4oo44Inle dx,pos zQ8kn177iMP6 from xcRQbFu -pos zQ8kn177iMP6 to xcRQbFu +1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
        else
            dx=min JDDUobOmXqpDbWPXcxt4oo44Inle dx,pos zQ8kn177iMP6 from xcRQbFu -pos zQ8kn177iMP6 pk zQ8kn177iMP6 from xcRQbFu  xcRQbFu +1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
		int ll,rr;
         jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ju jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
         jWEH5wdkwIL2DbhCh9DRnXv 
        	ll=x+1;
        	rr=x+dx;
         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
        else
         jWEH5wdkwIL2DbhCh9DRnXv 
        	ll=pom zQ8kn177iMP6 x xcRQbFu -dx+1;
        	rr=pom zQ8kn177iMP6 x xcRQbFu ;
         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
         jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle query JDDUobOmXqpDbWPXcxt4oo44Inle flag,ll,rr jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI !=query JDDUobOmXqpDbWPXcxt4oo44Inle 2,pos zQ8kn177iMP6 from xcRQbFu -dx+1,pos zQ8kn177iMP6 from xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
         jWEH5wdkwIL2DbhCh9DRnXv 
        	int low=0,high=dx,mid;
        	int px=x,pf=from;
        	while JDDUobOmXqpDbWPXcxt4oo44Inle low<=high jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
        	 jWEH5wdkwIL2DbhCh9DRnXv 
	        	mid= JDDUobOmXqpDbWPXcxt4oo44Inle low+high jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI >>1;
        	     jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ju jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
        	     jWEH5wdkwIL2DbhCh9DRnXv 
    	        	ll=x+1;
    	        	rr=x+mid;
    	         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
    	        else
    	         jWEH5wdkwIL2DbhCh9DRnXv 
    	           ll=pom zQ8kn177iMP6 x xcRQbFu -mid+1;
    	           rr=pom zQ8kn177iMP6 x xcRQbFu ;
        	     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
        	     jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle query JDDUobOmXqpDbWPXcxt4oo44Inle flag,ll,rr jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  KlopQXZvnuiuasdbbnbdsaioqw query JDDUobOmXqpDbWPXcxt4oo44Inle 2,pos zQ8kn177iMP6 from xcRQbFu -mid+1,pos zQ8kn177iMP6 from xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
        	        low=mid+1;
    	        else
    	            high=mid-1; 
	         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	         jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ju jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	           x+=high;
            else
             jWEH5wdkwIL2DbhCh9DRnXv 
            	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle high>0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
                	x=pa zQ8kn177iMP6 lm zQ8kn177iMP6 pom zQ8kn177iMP6 x xcRQbFu -high+1 xcRQbFu  xcRQbFu ;
             D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
             jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle high>0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
			     from=pe zQ8kn177iMP6 list zQ8kn177iMP6 pos zQ8kn177iMP6 from xcRQbFu -high+1 xcRQbFu  xcRQbFu ;
          	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle !ju&&x KlopQXZvnuiuasdbbnbdsaioqw lca jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	     	 jWEH5wdkwIL2DbhCh9DRnXv 
	    		ju=true;
	         	x=pom zQ8kn177iMP6 x xcRQbFu ;
	     	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc   
	         jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ju&&x KlopQXZvnuiuasdbbnbdsaioqw pom zQ8kn177iMP6 ls zQ8kn177iMP6 u-1 xcRQbFu  xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
             jWEH5wdkwIL2DbhCh9DRnXv 
            	u--;
            	x=pom zQ8kn177iMP6 ps zQ8kn177iMP6 ls zQ8kn177iMP6 u-1 xcRQbFu  xcRQbFu  xcRQbFu -1;
             D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
			 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ju KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
			   ch=pd zQ8kn177iMP6 x xcRQbFu ;
			else
			   ch=pd zQ8kn177iMP6 lm zQ8kn177iMP6 x+1 xcRQbFu  xcRQbFu ;
			 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle pc zQ8kn177iMP6 from xcRQbFu <ch jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
			   return -1;
			 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle pc zQ8kn177iMP6 from xcRQbFu >ch jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
			   return 1;
         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
         jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ju jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
           x+=dx;
        else
          	x=pa zQ8kn177iMP6 lm zQ8kn177iMP6 pom zQ8kn177iMP6 x xcRQbFu -dx+1 xcRQbFu  xcRQbFu ;
        from=pe zQ8kn177iMP6 list zQ8kn177iMP6 pos zQ8kn177iMP6 from xcRQbFu -dx+1 xcRQbFu  xcRQbFu ;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle !ju&&x KlopQXZvnuiuasdbbnbdsaioqw lca jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		ju=true;
		x=pom zQ8kn177iMP6 x xcRQbFu ;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle !ju||x!=pom zQ8kn177iMP6 y xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	   return 0;
	return 1;
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
void gwp JDDUobOmXqpDbWPXcxt4oo44Inle int id,int pr jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int i,j,s,p,q,ip;
	zz zQ8kn177iMP6 id xcRQbFu =1;
	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<adj zQ8kn177iMP6 id xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		ip=adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu .id;
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ip KlopQXZvnuiuasdbbnbdsaioqw pr||vis zQ8kn177iMP6 ip xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		   continue;
        gwp JDDUobOmXqpDbWPXcxt4oo44Inle ip,id jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
        zz zQ8kn177iMP6 id xcRQbFu +=zz zQ8kn177iMP6 ip xcRQbFu ;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
void dfs JDDUobOmXqpDbWPXcxt4oo44Inle int id jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int i,j,s,p,q,x,y,ip,ie,u,ch;
	bool ju; 
     iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<adj zQ8kn177iMP6 id xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
     jWEH5wdkwIL2DbhCh9DRnXv 
    	ip=adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu .id;
	   	vec zQ8kn177iMP6 ip xcRQbFu .clear JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
    gwp JDDUobOmXqpDbWPXcxt4oo44Inle id,-1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    construct JDDUobOmXqpDbWPXcxt4oo44Inle id,0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
     iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<vr zQ8kn177iMP6 id xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
     jWEH5wdkwIL2DbhCh9DRnXv 
    	x=id;
    	y=vr zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu .y;
        cnt_ls=0;
       	ip=lca JDDUobOmXqpDbWPXcxt4oo44Inle x,y jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
	    while JDDUobOmXqpDbWPXcxt4oo44Inle true jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	     jWEH5wdkwIL2DbhCh9DRnXv 
		    ls zQ8kn177iMP6 cnt_ls++ xcRQbFu =y;
		     jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ps zQ8kn177iMP6 y xcRQbFu  KlopQXZvnuiuasdbbnbdsaioqw ps zQ8kn177iMP6 ip xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		        break;
			y=pa zQ8kn177iMP6 ps zQ8kn177iMP6 y xcRQbFu  xcRQbFu ;
    	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
    	y=vr zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu .y;
    	ans zQ8kn177iMP6 vr zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu .id xcRQbFu +=solve JDDUobOmXqpDbWPXcxt4oo44Inle to zQ8kn177iMP6 id xcRQbFu ,ip,x,y,0,cnt_ls jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI -1;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
    vis zQ8kn177iMP6 id xcRQbFu =true;
     iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle int ii=0;ii<adj zQ8kn177iMP6 id xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;ii++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
     jWEH5wdkwIL2DbhCh9DRnXv 
    	ip=adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 ii xcRQbFu .id;
    	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle vec zQ8kn177iMP6 ip xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
    	    continue;
	    pw zQ8kn177iMP6 ip xcRQbFu =adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 ii xcRQbFu .ch-'a';
	    construct JDDUobOmXqpDbWPXcxt4oo44Inle ip,1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
	    pc zQ8kn177iMP6 to zQ8kn177iMP6 ip xcRQbFu  xcRQbFu =pw zQ8kn177iMP6 ip xcRQbFu ;
		 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle int jj=0;jj<vec zQ8kn177iMP6 ip xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;jj++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	     jWEH5wdkwIL2DbhCh9DRnXv 
	    	int xx=vec zQ8kn177iMP6 ip xcRQbFu  zQ8kn177iMP6 jj xcRQbFu ;
	    	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle j=0;j<vr zQ8kn177iMP6 xx xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;j++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	    	 jWEH5wdkwIL2DbhCh9DRnXv 
	        	x=xx;
	        	y=vr zQ8kn177iMP6 xx xcRQbFu  zQ8kn177iMP6 j xcRQbFu .y;
	        	int ipe=lca JDDUobOmXqpDbWPXcxt4oo44Inle x,y jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
	        	cnt_ls=0;
	         	while JDDUobOmXqpDbWPXcxt4oo44Inle true jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	        	 jWEH5wdkwIL2DbhCh9DRnXv 
	         		ls zQ8kn177iMP6 cnt_ls++ xcRQbFu =y;
	        		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle ps zQ8kn177iMP6 y xcRQbFu  KlopQXZvnuiuasdbbnbdsaioqw ps zQ8kn177iMP6 ipe xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	        		    break;
 		            y=pa zQ8kn177iMP6 ps zQ8kn177iMP6 y xcRQbFu  xcRQbFu ;
 	        	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
 	        	y=vr zQ8kn177iMP6 xx xcRQbFu  zQ8kn177iMP6 j xcRQbFu .y;
	        	u=cnt_ls;
	        	ju=false;
		    	int mf=get_path JDDUobOmXqpDbWPXcxt4oo44Inle to zQ8kn177iMP6 x xcRQbFu ,to zQ8kn177iMP6 ip xcRQbFu ,x,y,ipe,ju,u jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
				 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle mf KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	         	 jWEH5wdkwIL2DbhCh9DRnXv 
	    	    	int nx,nch,nu;
	        		bool nju;
	        		nju=ju;
	        		nu=u;
	         		nx=x;
	        		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle !ju|| JDDUobOmXqpDbWPXcxt4oo44Inle x!=pom zQ8kn177iMP6 y xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	    	    	 jWEH5wdkwIL2DbhCh9DRnXv 
	    	        	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle !nju&&nx KlopQXZvnuiuasdbbnbdsaioqw ipe jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	    		         jWEH5wdkwIL2DbhCh9DRnXv 
		    		       nju=true;
		    		       nx=pom zQ8kn177iMP6 nx xcRQbFu ;
		    	         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
		    	         jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle nju&&nx KlopQXZvnuiuasdbbnbdsaioqw pom zQ8kn177iMP6 ls zQ8kn177iMP6 nu-1 xcRQbFu  xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
                         jWEH5wdkwIL2DbhCh9DRnXv 
                        	nu--;
                        	nx=pom zQ8kn177iMP6 ps zQ8kn177iMP6 ls zQ8kn177iMP6 nu-1 xcRQbFu  xcRQbFu  xcRQbFu -1;
                         D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
                         jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle nju jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
                         jWEH5wdkwIL2DbhCh9DRnXv 
                        	nch=pd zQ8kn177iMP6 lm zQ8kn177iMP6 nx+1 xcRQbFu  xcRQbFu ;
                            nx++;
				     	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
				    	else
				    	 jWEH5wdkwIL2DbhCh9DRnXv 
                           nch=pd zQ8kn177iMP6 nx xcRQbFu ;
                           nx=pa zQ8kn177iMP6 nx xcRQbFu ;
					     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
					     jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle nch KlopQXZvnuiuasdbbnbdsaioqw pw zQ8kn177iMP6 ip xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
    						ans zQ8kn177iMP6 vr zQ8kn177iMP6 xx xcRQbFu  zQ8kn177iMP6 j xcRQbFu .id xcRQbFu -=solve JDDUobOmXqpDbWPXcxt4oo44Inle to zQ8kn177iMP6 ip xcRQbFu ,ipe,nx,y,nju,nu jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    					else  jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle pw zQ8kn177iMP6 ip xcRQbFu <nch jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
					    	ans zQ8kn177iMP6 vr zQ8kn177iMP6 xx xcRQbFu  zQ8kn177iMP6 j xcRQbFu .id xcRQbFu -=zz zQ8kn177iMP6 ip xcRQbFu ;
	    	    	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	    	    	ans zQ8kn177iMP6 vr zQ8kn177iMP6 xx xcRQbFu  zQ8kn177iMP6 j xcRQbFu .id xcRQbFu +=solve JDDUobOmXqpDbWPXcxt4oo44Inle to zQ8kn177iMP6 id xcRQbFu ,ipe,x,y,ju,u jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
				 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
				else  jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle mf<0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
				    ans zQ8kn177iMP6 vr zQ8kn177iMP6 xx xcRQbFu  zQ8kn177iMP6 j xcRQbFu .id xcRQbFu +=zz zQ8kn177iMP6 id xcRQbFu -zz zQ8kn177iMP6 ip xcRQbFu ;
			 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	    cnt_list-=num_node-to zQ8kn177iMP6 ip xcRQbFu ;
	    num_node=to zQ8kn177iMP6 ip xcRQbFu ;
     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
     iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<adj zQ8kn177iMP6 id xcRQbFu .size JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
     jWEH5wdkwIL2DbhCh9DRnXv 
    	ip=adj zQ8kn177iMP6 id xcRQbFu  zQ8kn177iMP6 i xcRQbFu .id;
    	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle !vis zQ8kn177iMP6 ip xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
    	 jWEH5wdkwIL2DbhCh9DRnXv 
	        get_size JDDUobOmXqpDbWPXcxt4oo44Inle ip,-1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
            mi=mod;
            choose_root JDDUobOmXqpDbWPXcxt4oo44Inle ip,-1,0,ch jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
             jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle mi<mod jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	       	    dfs JDDUobOmXqpDbWPXcxt4oo44Inle ch jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
		 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
int main JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
 jWEH5wdkwIL2DbhCh9DRnXv 
	int id1,id2,i,j,s,p,q,x,y;
	int ch;
	scanf JDDUobOmXqpDbWPXcxt4oo44Inle "%d%d",&n,&num_q jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<=n;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle i KlopQXZvnuiuasdbbnbdsaioqw 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		   ex zQ8kn177iMP6 i xcRQbFu =1;
        else
           ex zQ8kn177iMP6 i xcRQbFu = JDDUobOmXqpDbWPXcxt4oo44Inle int jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  JDDUobOmXqpDbWPXcxt4oo44Inle  JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ex zQ8kn177iMP6 i-1 xcRQbFu * JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI base%mod jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<400000;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	   pk zQ8kn177iMP6 i xcRQbFu =i;
	 iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<n-1;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
	 jWEH5wdkwIL2DbhCh9DRnXv 
		scanf JDDUobOmXqpDbWPXcxt4oo44Inle "%d%d",&id1,&id2 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
		ch=getchar JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
		while JDDUobOmXqpDbWPXcxt4oo44Inle ch<'a'||ch>'z' jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
		   ch=getchar JDDUobOmXqpDbWPXcxt4oo44Inle  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
		id1--;
		id2--;
		now.id=id2;
		now.ch=ch;
		adj zQ8kn177iMP6 id1 xcRQbFu .push_back JDDUobOmXqpDbWPXcxt4oo44Inle now jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
		now.id=id1;
		adj zQ8kn177iMP6 id2 xcRQbFu .push_back JDDUobOmXqpDbWPXcxt4oo44Inle now jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
     iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<n;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
       ps zQ8kn177iMP6 i xcRQbFu =i;
    prp JDDUobOmXqpDbWPXcxt4oo44Inle 0,-1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    gps JDDUobOmXqpDbWPXcxt4oo44Inle 0 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    ha zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 0 xcRQbFu =0;
     iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<cnt_lm;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
     jWEH5wdkwIL2DbhCh9DRnXv 
    	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle i+1<cnt_lm jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
    	 jWEH5wdkwIL2DbhCh9DRnXv 
    	    ha zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 i+1 xcRQbFu = JDDUobOmXqpDbWPXcxt4oo44Inle int jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  JDDUobOmXqpDbWPXcxt4oo44Inle  JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ha zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 i xcRQbFu * JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI base%mod jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
        	ha zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 i+1 xcRQbFu = JDDUobOmXqpDbWPXcxt4oo44Inle ha zQ8kn177iMP6 0 xcRQbFu  zQ8kn177iMP6 i+1 xcRQbFu +pd zQ8kn177iMP6 lm zQ8kn177iMP6 i+1 xcRQbFu  xcRQbFu +1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI %mod;
    	 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
		ps zQ8kn177iMP6 lm zQ8kn177iMP6 i xcRQbFu  xcRQbFu =ps zQ8kn177iMP6 ps zQ8kn177iMP6 lm zQ8kn177iMP6 i xcRQbFu  xcRQbFu  xcRQbFu ;
     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
    ha zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 cnt_lm-1 xcRQbFu =pd zQ8kn177iMP6 lm zQ8kn177iMP6 cnt_lm-1 xcRQbFu  xcRQbFu +1;
     iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=cnt_lm-2;i>=0;i-- jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
     jWEH5wdkwIL2DbhCh9DRnXv 
    	ha zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 i xcRQbFu = JDDUobOmXqpDbWPXcxt4oo44Inle int jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  JDDUobOmXqpDbWPXcxt4oo44Inle  JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ha zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 i+1 xcRQbFu * JDDUobOmXqpDbWPXcxt4oo44Inle long long jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI base%mod jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    	ha zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 i xcRQbFu = JDDUobOmXqpDbWPXcxt4oo44Inle ha zQ8kn177iMP6 1 xcRQbFu  zQ8kn177iMP6 i xcRQbFu +pd zQ8kn177iMP6 lm zQ8kn177iMP6 i xcRQbFu  xcRQbFu +1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI %mod;
     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
     iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<num_q;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
     jWEH5wdkwIL2DbhCh9DRnXv 
    	scanf JDDUobOmXqpDbWPXcxt4oo44Inle "%d%d",&x,&y jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    	x--;
    	y--;
    	nw.y=y;
    	nw.id=i;
    	vr zQ8kn177iMP6 x xcRQbFu .push_back JDDUobOmXqpDbWPXcxt4oo44Inle nw jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
     D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 
    num_node=0;
    get_size JDDUobOmXqpDbWPXcxt4oo44Inle 0,-1 jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    mi=mod;
    choose_root JDDUobOmXqpDbWPXcxt4oo44Inle 0,-1,0,ch jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
    cnt_list=0;
    pw zQ8kn177iMP6 ch xcRQbFu =-1;
    memset JDDUobOmXqpDbWPXcxt4oo44Inle ans,0,sizeof JDDUobOmXqpDbWPXcxt4oo44Inle ans jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
	 jmsdfkWQEr22FSD234SDFFwasd  JDDUobOmXqpDbWPXcxt4oo44Inle mi<mod jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
       dfs JDDUobOmXqpDbWPXcxt4oo44Inle ch jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
     iuasiudiaosudjbppjbnbcxhgjhjhsgdgjh  JDDUobOmXqpDbWPXcxt4oo44Inle i=0;i<num_q;i++ jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI 
       printf JDDUobOmXqpDbWPXcxt4oo44Inle "%d\n",ans zQ8kn177iMP6 i xcRQbFu  jXgZRr2cuiRXx3yGgEeJ4MHSuQ8GVOEK3SUVExK3HI ;
	return 0;
 D5AdvfYK2jY0V0AjaxQNKjP7zRxlwFSR2kxVkQYOMtc 