
import java.util.Scanner;

public class B843 {

	static Scanner s;
	static boolean offline = false;

	public static int[] offlineQuery(int ind) {
		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		

		int[][] ans = { { 60, -1 }, { 30, 4 }, { 20, 2 }, { 40, 5 }, { 50, 1 } };
		return ans[ind - 1];
	}

	public static int[] query(int ind) {
		System.out.println("? " + ind);
		System.out.flush();
		if (!offline) {
			int val = s.nextInt(), next = s.nextInt();
			if (val == -1 && next == -1) {
				System.exit(0);
			}
			return new int[] { val, next };
		} else {
			return offlineQuery(ind);
		}
	}

	public static void finish(int ans) {
		System.out.println("! " + ans);
		System.out.flush();
		s.close();
	}

	public static void main(String[] args) {

		s = new Scanner(System.in);

		int N, start, X;
		if (!offline) {
			N = s.nextInt();
			start = s.nextInt();
			X = s.nextInt();
		} else {
			N = 5;
			start = 3;
			X = 75;
		}
		int guesses = 1;
		int[] query = query(start);
		if (query[0] >= X) {
			finish(query[0]);
			return;
		}
		int bestVal = query[0], bestInd = query[1];

		while (guesses < 1000) {
			int att = (int) (Math.random() * N) + 1;
			

			

			query = query(att);
			

			guesses++;
			if (query[0] == X) {
				finish(query[0]);
				return;
			}
			if (query[0] > X)
				continue;
			if (query[0] > bestVal) {
				bestVal = query[0];
				bestInd = query[1];
			}
		}

		


		while (bestInd != -1 && guesses < 1999) {
			query = query(bestInd);
			if (query[0] >= X) {
				finish(query[0]);
				return;
			}
			bestInd = query[1];
		}

		if (bestInd == -1) {
			finish(-1);
		} else {
			finish(bestVal);
		}
		s.close();

	}

}
