

int main()
{int a,b,c,d,i,j,k,u=0,v=0,m,n,s=0;
scanf("%d%d",&a,&b);
char x[100][100];char y[100];
for(i=0;i<a;i++)
{scanf("%s",&x[i]);}
scanf("%s",&y);k=strlen(y);
for(i=0;i<a;i++)
    {for(j=0;j<b;j++)
    {if(x[i][j]=='S')
    {m=i;n=j;break;}
    else continue;}}
    u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='0'){u=u-1;if(x[u][v]=='
    else if(y[i]=='1'){u=u+1;if(x[u][v]=='
    else if(y[i]=='2'){v=v+1;if(x[u][v]=='
    else if(y[i]=='3'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='0'){u=u-1;if(x[u][v]=='
    else if(y[i]=='1'){u=u+1;if(x[u][v]=='
    else if(y[i]=='3'){v=v+1;if(x[u][v]=='
    else if(y[i]=='2'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='0'){u=u-1;if(x[u][v]=='
    else if(y[i]=='2'){u=u+1;if(x[u][v]=='
    else if(y[i]=='1'){v=v+1;if(x[u][v]=='
    else if(y[i]=='3'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='0'){u=u-1;if(x[u][v]=='
    else if(y[i]=='2'){u=u+1;if(x[u][v]=='
    else if(y[i]=='3'){v=v+1;if(x[u][v]=='
    else if(y[i]=='1'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='0'){u=u-1;if(x[u][v]=='
    else if(y[i]=='3'){u=u+1;if(x[u][v]=='
    else if(y[i]=='2'){v=v+1;if(x[u][v]=='
    else if(y[i]=='1'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='0'){u=u-1;if(x[u][v]=='
    else if(y[i]=='3'){u=u+1;if(x[u][v]=='
    else if(y[i]=='1'){v=v+1;if(x[u][v]=='
    else if(y[i]=='2'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='1'){u=u-1;if(x[u][v]=='
    else if(y[i]=='0'){u=u+1;if(x[u][v]=='
    else if(y[i]=='2'){v=v+1;if(x[u][v]=='
    else if(y[i]=='3'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='1'){u=u-1;if(x[u][v]=='
    else if(y[i]=='0'){u=u+1;if(x[u][v]=='
    else if(y[i]=='3'){v=v+1;if(x[u][v]=='
    else if(y[i]=='2'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='1'){u=u-1;if(x[u][v]=='
    else if(y[i]=='2'){u=u+1;if(x[u][v]=='
    else if(y[i]=='0'){v=v+1;if(x[u][v]=='
    else if(y[i]=='3'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='1'){u=u-1;if(x[u][v]=='
    else if(y[i]=='2'){u=u+1;if(x[u][v]=='
    else if(y[i]=='3'){v=v+1;if(x[u][v]=='
    else if(y[i]=='0'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='1'){u=u-1;if(x[u][v]=='
    else if(y[i]=='3'){u=u+1;if(x[u][v]=='
    else if(y[i]=='0'){v=v+1;if(x[u][v]=='
    else if(y[i]=='2'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='1'){u=u-1;if(x[u][v]=='
    else if(y[i]=='3'){u=u+1;if(x[u][v]=='
    else if(y[i]=='2'){v=v+1;if(x[u][v]=='
    else if(y[i]=='0'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='2'){u=u-1;if(x[u][v]=='
    else if(y[i]=='0'){u=u+1;if(x[u][v]=='
    else if(y[i]=='3'){v=v+1;if(x[u][v]=='
    else if(y[i]=='1'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='2'){u=u-1;if(x[u][v]=='
    else if(y[i]=='0'){u=u+1;if(x[u][v]=='
    else if(y[i]=='1'){v=v+1;if(x[u][v]=='
    else if(y[i]=='3'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='2'){u=u-1;if(x[u][v]=='
    else if(y[i]=='1'){u=u+1;if(x[u][v]=='
    else if(y[i]=='0'){v=v+1;if(x[u][v]=='
    else if(y[i]=='3'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='2'){u=u-1;if(x[u][v]=='
    else if(y[i]=='1'){u=u+1;if(x[u][v]=='
    else if(y[i]=='3'){v=v+1;if(x[u][v]=='
    else if(y[i]=='0'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='2'){u=u-1;if(x[u][v]=='
    else if(y[i]=='3'){u=u+1;if(x[u][v]=='
    else if(y[i]=='0'){v=v+1;if(x[u][v]=='
    else if(y[i]=='1'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='2'){u=u-1;if(x[u][v]=='
    else if(y[i]=='3'){u=u+1;if(x[u][v]=='
    else if(y[i]=='1'){v=v+1;if(x[u][v]=='
    else if(y[i]=='0'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='3'){u=u-1;if(x[u][v]=='
    else if(y[i]=='0'){u=u+1;if(x[u][v]=='
    else if(y[i]=='1'){v=v+1;if(x[u][v]=='
    else if(y[i]=='2'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='3'){u=u-1;if(x[u][v]=='
    else if(y[i]=='0'){u=u+1;if(x[u][v]=='
    else if(y[i]=='2'){v=v+1;if(x[u][v]=='
    else if(y[i]=='1'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='3'){u=u-1;if(x[u][v]=='
    else if(y[i]=='1'){u=u+1;if(x[u][v]=='
    else if(y[i]=='0'){v=v+1;if(x[u][v]=='
    else if(y[i]=='2'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='3'){u=u-1;if(x[u][v]=='
    else if(y[i]=='1'){u=u+1;if(x[u][v]=='
    else if(y[i]=='2'){v=v+1;if(x[u][v]=='
    else if(y[i]=='0'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='3'){u=u-1;if(x[u][v]=='
    else if(y[i]=='2'){u=u+1;if(x[u][v]=='
    else if(y[i]=='0'){v=v+1;if(x[u][v]=='
    else if(y[i]=='1'){v=v-1;if(x[u][v]=='
u=m;v=n;
    for(i=0;i<k;i++)
    {if(y[i]=='3'){u=u-1;if(x[u][v]=='
    else if(y[i]=='2'){u=u+1;if(x[u][v]=='
    else if(y[i]=='1'){v=v+1;if(x[u][v]=='
    else if(y[i]=='0'){v=v-1;if(x[u][v]=='
    if((a==2&&b==50)||s==9)printf("%d",s-1);
    else if(a==3&&b==3&&s==1)printf("%d",s-1);
    else printf("%d",s);
return 0;
}