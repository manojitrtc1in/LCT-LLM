



























































































































































































































































































































































































































typedef long long ll;
cl_usstd(max,min);











ll readll(void){ll x=0,w=1;char c=getchar();for(;c<'0'||c>'9';(c-'-')||(w=-w),c=getchar());for(;c>='0'&&c<='9';x=(x<<1)+(x<<3)+(c^48),c=getchar());return x*w;}
ll readchar(void){char c=getchar();for(;c<=34;c=getchar());return c;} 
bool id0(char*a){char c=getchar();ll top=0;for(ll i=1;i<=1234&&(c<=34||c>=99);i++,c=getchar())if(i==1045)return 0;a[0]=c;c=getchar();for(;c>27&&c<99;c=-1,c=getchar())if(c^' ')a[++top]=c;a[++top]=0;return 1;} 






























const ll mod=1000000007;
ll riar(722222,f);



ll fi(ll u){return f[u]^u?f[u]=fi(f[u]):u;}
int main(){


	ll rill(n,k);


	rep(i,1,2*n+2)f[i]=i;
	rep(i,1,k){
		ll rill(x,y);
		ll left=y-x+1,right=y+x-1;
		if(left<1)left=2-left; 
		if(right>n)right=2*n-right; 
		debug("%lld %lld\n",left,right);
		left=zh(left),
		right=zh(right);
		char c=readchar();
		if(c=='o'){
			f[fi(ji(left))]=fi(ou(right+1));
			debug("%lld %lld\n",ji(left),ou(right+1));
			f[fi(ou(left))]=fi(ji(right+1));
			debug("%lld %lld\n",ou(left),ji(right+1));
		}
		else {
			f[fi(ji(left))]=fi(ji(right+1));
			debug("%lld %lld\n",ji(left),ji(right+1));
			f[fi(ou(left))]=fi(ou(right+1));
			debug("%lld %lld\n",ou(left),ou(right+1));
		}
	}
	ll ri0(C,ans)+1;
	rep(i,1,2*n+2){
		if(f[i]==i)C++;
		if(i<=n+1&&fi(i)==fi(i+n+1)){
			debug("%lld %lld\n",i,i+n+1);
			puts("0");
			return 0;
		}
	}
	rep(i,1,C/2-1)(ans*=2)%=mod;
	printf("%lld\n",ans);
	return 0;
} 