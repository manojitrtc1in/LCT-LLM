

using namespace std;



template<typename xxsHSZV8JYVT>ostream&operator<<(ostream&id4,
const vector<xxsHSZV8JYVT>&id14){id4<<"\x7b";for(
auto id23=id14.begin();id23!=
id14.end();++id23){if(id23!=
id14.begin())id4<<"\x2c\x20";id4<<*
id23;}return id4<<"\x7d";}



template<typename xxsHSZV8JYVF,typename xxsHSZV8JYVS>ostream&operator<<(
ostream&id4,const pair<xxsHSZV8JYVF,xxsHSZV8JYVS>&
id3){return id4<<"\x28"<<id3.first<<
"\x2c\x20"<<id3.second<<"\x29";}

template<typename xxsHSZV8JYVT>ostream&operator<<(ostream&id4,
const set<xxsHSZV8JYVT>&id14){id4<<"\x5b";for(auto
 id23=id14.begin();id23!=id14.
end();++id23){if(id23!=id14.begin())
id4<<"\x2c\x20";id4<<*id23;}return 
id4<<"\x5d";}


xxsHSZV8JYVx.end()




template<typename xxsHSZV8JYVT>ostream&operator<<(ostream&id4,
const multiset<xxsHSZV8JYVT>&id14){id4<<"\x5b";for
(auto id23=id14.begin();id23!=
id14.end();++id23){if(id23!=
id14.begin())id4<<"\x2c\x20";id4<<*
id23;}return id4<<"\x5d";}

xxsHSZV8JYVx )cout<<xxsHSZV8JYVt<<"\x20";

id17<id1;id17++)

id9<id1;id9++)


xxsHSZV8JYVvi id5(id1);id2(\
id1){cin>>id5[id17];}



id22) id2(id1){id0(\
id22) cin>>xxsHSZV8JYVnum[id17][id9];}

id22) id2(id1){id0(\
id22) cout<<xxsHSZV8JYVnum[id17][id9]<<\
"\x20"; cout<<endl;}
template<typename xxsHSZV8JYVF,typename xxsHSZV8JYVS>ostream&operator<<(
ostream&id4,const map<xxsHSZV8JYVF,xxsHSZV8JYVS>&
id14){id4<<"\x5b";for(auto id23=
id14.begin();id23!=id14.end();++
id23){if(id23!=id14.begin())
id4<<"\x2c\x20";id4<<id23->first<<
"\x20\x3d\x20"<<id23->second;}return id4<<"\x5d";}

id5;

id5)id7(xxsHSZV8JYVb)

id18(id5,xxsHSZV8JYVb)id7(\
xxsHSZV8JYVc)

id27)id18(id5,xxsHSZV8JYVb)\
id18(xxsHSZV8JYVc,id27)

id27,id20)id21(id5,\
xxsHSZV8JYVb,xxsHSZV8JYVc,id27)id7(\
id20)

id27,id20,xxsHSZV8JYVf)id15(\
id5,xxsHSZV8JYVb,xxsHSZV8JYVc)id15(\
id27,id20,xxsHSZV8JYVf)

id27,id20,xxsHSZV8JYVf,xxsHSZV8JYVg)\
xxsHSZV8JYVtk6(id5,xxsHSZV8JYVb,xxsHSZV8JYVc,\
id27,id20,xxsHSZV8JYVf)id7(\
xxsHSZV8JYVg)

id27,id20,xxsHSZV8JYVf,xxsHSZV8JYVg,\
xxsHSZV8JYVh)xxsHSZV8JYVtk7(id5,xxsHSZV8JYVb,\
xxsHSZV8JYVc,id27,id20,xxsHSZV8JYVf,\
xxsHSZV8JYVg)id7(xxsHSZV8JYVh)










const int id26=1000000007;const int id29=100000;bool 
id13(map<int,char>&id11,string&
id6,vector<string>&id24,int id28,int 
id19,int id1,int id22){id2
(id6.xxsHSZV8JYVln){char id16=
id11[id6[id17]-
((char)(0x15fb+2735-0x207a))];if(id24[id19][
id28]==((char)(0x1f23+2086-0x2704)))return true;if(
id24[id19][id28]==
((char)(0xa6d+3549-0x1827)))return false;if(id16==
((char)(0x14f4+4240-0x252f))){if(id19!=0){id19--;}else
{return false;}}else if(id16==((char)(0x1ad5+1028-0x1e8d))){if(
id28!=0){id28--;}else{return false;}}else if(
id16==((char)(0x470+7668-0x2220))){if(id19!=
id1-1){id19++;}else{return false;}}else{if(
id28!=id22-1){id28++;}else{return false;}}
}if(id24[id19][id28]==
((char)(0x11c7+4822-0x2458)))return true;return false;}int32_t main(){ios_base::
sync_with_stdio(false);cin.tie(0);string id5="\x55\x44\x4c\x52";
sort(xxsHSZV8JYVall(id5));map<int,char>id11[
24];int id17=0;do{id0(4){id11[
id17][id9]=id5[id9];}
id17++;}while(next_permutation(xxsHSZV8JYVall(id5))
);id18(id1,id22)vector<string>
id24(id1);id2(id1){cin
>>id24[id17];}string id6;cin>>
id6;int id28=-1;int id19=-1;
id17=0;bool id12=true;for(int id8=0;
id12&&id8<id1;id8++){
id0(id22){if(id24[id8]
[id9]==((char)(0x22a+5983-0x1936))){id19=
id8;id28=id9;id12=false;
break;}}}int id25=0;for(int id10=0;id10<24
;id10++){if(id13(id11[
id10],id6,id24,id28,
id19,id1,id22)){id25++;}}
xxsHSZV8JYVpf(id25)return 0;}

