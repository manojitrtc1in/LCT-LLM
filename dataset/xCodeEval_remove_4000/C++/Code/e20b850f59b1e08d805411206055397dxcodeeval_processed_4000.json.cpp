

using namespace std;
int n,m,a[100005],buc[300][10005],qa,qb,k,i,j,sum;
char c;
int main()
{
    ios_base::sync_with_stdio(NULL);
    cin.tie();
    cout.tie();
cin>>n>>m;
for (i=1;i<=260;++i)
    buc[i][0]=400;
for (i=1;i<=n;++i)
{
    cin>>a[i];
    buc[1+i/400][a[i]]++;
    buc[1+i/400][0]--;
    j=i;
    if (a[j]+buc[1+j/400][10001]==4||a[j]+buc[1+j/400][10001]==7||a[j]+buc[1+j/400][10001]==44||a[j]+buc[1+j/400][10001]==47||a[j]+buc[1+j/400][10001]==74||a[j]+buc[1+j/400][10001]==77||a[j]+buc[1+j/400][10001]==444||a[j]+buc[1+j/400][10001]==447||a[j]+buc[1+j/400][10001]==474||a[j]+buc[1+j/400][10001]==477||a[j]+buc[1+j/400][10001]==744||a[j]+buc[1+j/400][10001]==747||a[j]+buc[1+j/400][10001]==774||a[j]+buc[1+j/400][10001]==777||a[j]+buc[1+j/400][10001]==4444||a[j]+buc[1+j/400][10001]==4447||a[j]+buc[1+j/400][10001]==4474||a[j]+buc[1+j/400][10001]==4477||a[j]+buc[1+j/400][10001]==4744||a[j]+buc[1+j/400][10001]==4747||a[j]+buc[1+j/400][10001]==4774||a[j]+buc[1+j/400][10001]==4777||a[j]+buc[1+j/400][10001]==7444||a[j]+buc[1+j/400][10001]==7447||a[j]+buc[1+j/400][10001]==7474||a[j]+buc[1+j/400][10001]==7477||a[j]+buc[1+j/400][10001]==7744||a[j]+buc[1+j/400][10001]==7747||a[j]+buc[1+j/400][10001]==7774||a[j]+buc[1+j/400][10001]==7777)
    buc[1+j/400][10002]++;
}
for (i=1;i<=m;++i)
{
    cin.get();
    cin.get(c);
    if (c=='a') {cin.get();cin.get(); cin>>qa>>qb>>k;
    for (j=qa;j<(qa-1)/400*400+400&&j<=qb;++j)
        {if (a[j]+buc[1+j/400][10001]==4||a[j]+buc[1+j/400][10001]==7||a[j]+buc[1+j/400][10001]==44||a[j]+buc[1+j/400][10001]==47||a[j]+buc[1+j/400][10001]==74||a[j]+buc[1+j/400][10001]==77||a[j]+buc[1+j/400][10001]==444||a[j]+buc[1+j/400][10001]==447||a[j]+buc[1+j/400][10001]==474||a[j]+buc[1+j/400][10001]==477||a[j]+buc[1+j/400][10001]==744||a[j]+buc[1+j/400][10001]==747||a[j]+buc[1+j/400][10001]==774||a[j]+buc[1+j/400][10001]==777||a[j]+buc[1+j/400][10001]==4444||a[j]+buc[1+j/400][10001]==4447||a[j]+buc[1+j/400][10001]==4474||a[j]+buc[1+j/400][10001]==4477||a[j]+buc[1+j/400][10001]==4744||a[j]+buc[1+j/400][10001]==4747||a[j]+buc[1+j/400][10001]==4774||a[j]+buc[1+j/400][10001]==4777||a[j]+buc[1+j/400][10001]==7444||a[j]+buc[1+j/400][10001]==7447||a[j]+buc[1+j/400][10001]==7474||a[j]+buc[1+j/400][10001]==7477||a[j]+buc[1+j/400][10001]==7744||a[j]+buc[1+j/400][10001]==7747||a[j]+buc[1+j/400][10001]==7774||a[j]+buc[1+j/400][10001]==7777)
            buc[1+j/400][10002]--;
            buc[1+j/400][a[j]]--; a[j]+=k; buc[1+j/400][a[j]]++;
         if (a[j]+buc[1+j/400][10001]==4||a[j]+buc[1+j/400][10001]==7||a[j]+buc[1+j/400][10001]==44||a[j]+buc[1+j/400][10001]==47||a[j]+buc[1+j/400][10001]==74||a[j]+buc[1+j/400][10001]==77||a[j]+buc[1+j/400][10001]==444||a[j]+buc[1+j/400][10001]==447||a[j]+buc[1+j/400][10001]==474||a[j]+buc[1+j/400][10001]==477||a[j]+buc[1+j/400][10001]==744||a[j]+buc[1+j/400][10001]==747||a[j]+buc[1+j/400][10001]==774||a[j]+buc[1+j/400][10001]==777||a[j]+buc[1+j/400][10001]==4444||a[j]+buc[1+j/400][10001]==4447||a[j]+buc[1+j/400][10001]==4474||a[j]+buc[1+j/400][10001]==4477||a[j]+buc[1+j/400][10001]==4744||a[j]+buc[1+j/400][10001]==4747||a[j]+buc[1+j/400][10001]==4774||a[j]+buc[1+j/400][10001]==4777||a[j]+buc[1+j/400][10001]==7444||a[j]+buc[1+j/400][10001]==7447||a[j]+buc[1+j/400][10001]==7474||a[j]+buc[1+j/400][10001]==7477||a[j]+buc[1+j/400][10001]==7744||a[j]+buc[1+j/400][10001]==7747||a[j]+buc[1+j/400][10001]==7774||a[j]+buc[1+j/400][10001]==7777)
            buc[1+j/400][10002]++;}
    for (;j+400<=qb;j=j+400)
        {buc[1+j/400][10001]+=k;
        buc[1+j/400][10002]=0;
        if (buc[1+j/400][10001]<=4)
            buc[1+j/400][10002]+=buc[1+j/400][4-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=7)
            buc[1+j/400][10002]+=buc[1+j/400][7-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=47)
            buc[1+j/400][10002]+=buc[1+j/400][47-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=74)
            buc[1+j/400][10002]+=buc[1+j/400][74-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=77)
            buc[1+j/400][10002]+=buc[1+j/400][77-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=44)
            buc[1+j/400][10002]+=buc[1+j/400][44-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=444)
            buc[1+j/400][10002]+=buc[1+j/400][444-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=447)
            buc[1+j/400][10002]+=buc[1+j/400][447-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=474)
            buc[1+j/400][10002]+=buc[1+j/400][474-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=477)
            buc[1+j/400][10002]+=buc[1+j/400][477-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=744)
            buc[1+j/400][10002]+=buc[1+j/400][744-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=747)
            buc[1+j/400][10002]+=buc[1+j/400][747-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=774)
            buc[1+j/400][10002]+=buc[1+j/400][774-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=777)
            buc[1+j/400][10002]+=buc[1+j/400][777-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=4444)
            buc[1+j/400][10002]+=buc[1+j/400][4444-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=4447)
            buc[1+j/400][10002]+=buc[1+j/400][4447-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=4474)
            buc[1+j/400][10002]+=buc[1+j/400][4474-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=4477)
            buc[1+j/400][10002]+=buc[1+j/400][4477-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=4744)
            buc[1+j/400][10002]+=buc[1+j/400][4744-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=4747)
            buc[1+j/400][10002]+=buc[1+j/400][4747-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=4774)
            buc[1+j/400][10002]+=buc[1+j/400][4774-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=4777)
            buc[1+j/400][10002]+=buc[1+j/400][4777-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=7444)
            buc[1+j/400][10002]+=buc[1+j/400][7444-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=7447)
            buc[1+j/400][10002]+=buc[1+j/400][7447-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=7474)
            buc[1+j/400][10002]+=buc[1+j/400][7474-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=7477)
            buc[1+j/400][10002]+=buc[1+j/400][7477-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=7744)
            buc[1+j/400][10002]+=buc[1+j/400][7744-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=7747)
            buc[1+j/400][10002]+=buc[1+j/400][7747-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=7774)
            buc[1+j/400][10002]+=buc[1+j/400][7774-buc[1+j/400][10001]];
        if (buc[1+j/400][10001]<=7777)
            buc[1+j/400][10002]+=buc[1+j/400][7777-buc[1+j/400][10001]];
        }
    for (;j<=qb;++j)
        {if (a[j]+buc[1+j/400][10001]==4||a[j]+buc[1+j/400][10001]==7||a[j]+buc[1+j/400][10001]==44||a[j]+buc[1+j/400][10001]==47||a[j]+buc[1+j/400][10001]==74||a[j]+buc[1+j/400][10001]==77||a[j]+buc[1+j/400][10001]==444||a[j]+buc[1+j/400][10001]==447||a[j]+buc[1+j/400][10001]==474||a[j]+buc[1+j/400][10001]==477||a[j]+buc[1+j/400][10001]==744||a[j]+buc[1+j/400][10001]==747||a[j]+buc[1+j/400][10001]==774||a[j]+buc[1+j/400][10001]==777||a[j]+buc[1+j/400][10001]==4444||a[j]+buc[1+j/400][10001]==4447||a[j]+buc[1+j/400][10001]==4474||a[j]+buc[1+j/400][10001]==4477||a[j]+buc[1+j/400][10001]==4744||a[j]+buc[1+j/400][10001]==4747||a[j]+buc[1+j/400][10001]==4774||a[j]+buc[1+j/400][10001]==4777||a[j]+buc[1+j/400][10001]==7444||a[j]+buc[1+j/400][10001]==7447||a[j]+buc[1+j/400][10001]==7474||a[j]+buc[1+j/400][10001]==7477||a[j]+buc[1+j/400][10001]==7744||a[j]+buc[1+j/400][10001]==7747||a[j]+buc[1+j/400][10001]==7774||a[j]+buc[1+j/400][10001]==7777)
            buc[1+j/400][10002]--;
            buc[1+j/400][a[j]]--; a[j]+=k; buc[1+j/400][a[j]]++;
         if (a[j]+buc[1+j/400][10001]==4||a[j]+buc[1+j/400][10001]==7||a[j]+buc[1+j/400][10001]==44||a[j]+buc[1+j/400][10001]==47||a[j]+buc[1+j/400][10001]==74||a[j]+buc[1+j/400][10001]==77||a[j]+buc[1+j/400][10001]==444||a[j]+buc[1+j/400][10001]==447||a[j]+buc[1+j/400][10001]==474||a[j]+buc[1+j/400][10001]==477||a[j]+buc[1+j/400][10001]==744||a[j]+buc[1+j/400][10001]==747||a[j]+buc[1+j/400][10001]==774||a[j]+buc[1+j/400][10001]==777||a[j]+buc[1+j/400][10001]==4444||a[j]+buc[1+j/400][10001]==4447||a[j]+buc[1+j/400][10001]==4474||a[j]+buc[1+j/400][10001]==4477||a[j]+buc[1+j/400][10001]==4744||a[j]+buc[1+j/400][10001]==4747||a[j]+buc[1+j/400][10001]==4774||a[j]+buc[1+j/400][10001]==4777||a[j]+buc[1+j/400][10001]==7444||a[j]+buc[1+j/400][10001]==7447||a[j]+buc[1+j/400][10001]==7474||a[j]+buc[1+j/400][10001]==7477||a[j]+buc[1+j/400][10001]==7744||a[j]+buc[1+j/400][10001]==7747||a[j]+buc[1+j/400][10001]==7774||a[j]+buc[1+j/400][10001]==7777)
            buc[1+j/400][10002]++;}
    }
    else {cin.get();cin.get();cin.get();cin.get(); cin>>qa>>qb;
    sum=0;
        for (j=qa;j<(qa-1)/400*400+400&&j<=qb;++j)
        {if (a[j]+buc[1+j/400][10001]==4||a[j]+buc[1+j/400][10001]==7||a[j]+buc[1+j/400][10001]==44||a[j]+buc[1+j/400][10001]==47||a[j]+buc[1+j/400][10001]==74||a[j]+buc[1+j/400][10001]==77||a[j]+buc[1+j/400][10001]==444||a[j]+buc[1+j/400][10001]==447||a[j]+buc[1+j/400][10001]==474||a[j]+buc[1+j/400][10001]==477||a[j]+buc[1+j/400][10001]==744||a[j]+buc[1+j/400][10001]==747||a[j]+buc[1+j/400][10001]==774||a[j]+buc[1+j/400][10001]==777||a[j]+buc[1+j/400][10001]==4444||a[j]+buc[1+j/400][10001]==4447||a[j]+buc[1+j/400][10001]==4474||a[j]+buc[1+j/400][10001]==4477||a[j]+buc[1+j/400][10001]==4744||a[j]+buc[1+j/400][10001]==4747||a[j]+buc[1+j/400][10001]==4774||a[j]+buc[1+j/400][10001]==4777||a[j]+buc[1+j/400][10001]==7444||a[j]+buc[1+j/400][10001]==7447||a[j]+buc[1+j/400][10001]==7474||a[j]+buc[1+j/400][10001]==7477||a[j]+buc[1+j/400][10001]==7744||a[j]+buc[1+j/400][10001]==7747||a[j]+buc[1+j/400][10001]==7774||a[j]+buc[1+j/400][10001]==7777)
            sum++;}
    for (;j+400<=qb;j=j+400)
    {
        sum+=buc[1+j/400][10002];

    }
    for (;j<=qb;++j)
        {if (a[j]+buc[1+j/400][10001]==4||a[j]+buc[1+j/400][10001]==7||a[j]+buc[1+j/400][10001]==44||a[j]+buc[1+j/400][10001]==47||a[j]+buc[1+j/400][10001]==74||a[j]+buc[1+j/400][10001]==77||a[j]+buc[1+j/400][10001]==444||a[j]+buc[1+j/400][10001]==447||a[j]+buc[1+j/400][10001]==474||a[j]+buc[1+j/400][10001]==477||a[j]+buc[1+j/400][10001]==744||a[j]+buc[1+j/400][10001]==747||a[j]+buc[1+j/400][10001]==774||a[j]+buc[1+j/400][10001]==777||a[j]+buc[1+j/400][10001]==4444||a[j]+buc[1+j/400][10001]==4447||a[j]+buc[1+j/400][10001]==4474||a[j]+buc[1+j/400][10001]==4477||a[j]+buc[1+j/400][10001]==4744||a[j]+buc[1+j/400][10001]==4747||a[j]+buc[1+j/400][10001]==4774||a[j]+buc[1+j/400][10001]==4777||a[j]+buc[1+j/400][10001]==7444||a[j]+buc[1+j/400][10001]==7447||a[j]+buc[1+j/400][10001]==7474||a[j]+buc[1+j/400][10001]==7477||a[j]+buc[1+j/400][10001]==7744||a[j]+buc[1+j/400][10001]==7747||a[j]+buc[1+j/400][10001]==7774||a[j]+buc[1+j/400][10001]==7777)
            sum++;}
        cout<<sum<<'\n';
    }
}
    return 0;
}
